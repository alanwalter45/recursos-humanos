var _0x441b=['file','size','nombreArchivo','.jpg','application/pdf','.pdf','.mp3','video/mp4','.mp4','destination','rename','unlink','path','img','/publicaciones/','/files/delete-publicacion','json','tipoArchivo','replace','photos','docs','/biometrico/','format','DD-MM-YYYY','chmodSync','777','exports','Router','multer','moment','post','/files/create-folder','parse','body','propietario','/public/assets/photos','mkdirSync','/imagen-perfil.jpg','pipe','status','send','/files/upload','single','imagen'];(function(_0x32a548,_0x4c0511){var _0x5d2fd6=function(_0x234667){while(--_0x234667){_0x32a548['push'](_0x32a548['shift']());}};_0x5d2fd6(++_0x4c0511);}(_0x441b,0xcb));var _0xbb78=function(_0xdf6f7f,_0x365373){_0xdf6f7f=_0xdf6f7f-0x0;var _0x2d38c4=_0x441b[_0xdf6f7f];return _0x2d38c4;};const express=require('express');const router=express[_0xbb78('0x0')]();const fs=require('fs');const multer=require(_0xbb78('0x1'));const upload=multer({'dest':__dirname+'/public/assets/photos'});const moment=require(_0xbb78('0x2'));router[_0xbb78('0x3')](_0xbb78('0x4'),(_0xc38bac,_0x449b16,_0x1ccc91)=>{const _0x19eea1=JSON[_0xbb78('0x5')](_0xc38bac[_0xbb78('0x6')]['json']);const _0x1c0bad=_0x19eea1[_0xbb78('0x7')];const _0x5d0b5e=__dirname+_0xbb78('0x8');if(!fs['existsSync'](_0x5d0b5e+'/'+_0x1c0bad)){fs[_0xbb78('0x9')](_0x5d0b5e+'/'+_0x1c0bad);fs['createReadStream'](_0x5d0b5e+_0xbb78('0xa'))[_0xbb78('0xb')](fs['createWriteStream'](_0x5d0b5e+'/'+_0x1c0bad+_0xbb78('0xa')));}_0x449b16[_0xbb78('0xc')](0xc8)[_0xbb78('0xd')](!![]);});router[_0xbb78('0x3')](_0xbb78('0xe'),upload[_0xbb78('0xf')](_0xbb78('0x10')),(_0x144f9d,_0x170641,_0x5b83b5)=>{let _0x1f725a=_0x144f9d[_0xbb78('0x11')];if(_0x1f725a==undefined){_0x170641[_0xbb78('0xc')](0xc8)[_0xbb78('0xd')](!![]);}else{let _0x466c49=_0x1f725a['path'];if(_0x1f725a[_0xbb78('0x12')]/0x400/0x400<=0x3){let _0x19c4cf=_0x144f9d[_0xbb78('0x6')][_0xbb78('0x13')];let _0x261c35=_0x144f9d[_0xbb78('0x6')][_0xbb78('0x7')];let _0x4a082b='';switch(_0x1f725a['mimetype']){case'image/jpeg':_0x4a082b=_0xbb78('0x14');break;case _0xbb78('0x15'):_0x4a082b=_0xbb78('0x16');break;case'audio/mp3':_0x4a082b=_0xbb78('0x17');break;case _0xbb78('0x18'):_0x4a082b=_0xbb78('0x19');break;}const _0xe057aa=_0x1f725a[_0xbb78('0x1a')]+'/'+_0x261c35+'/'+_0x19c4cf+_0x4a082b;fs[_0xbb78('0x1b')](_0x466c49,_0xe057aa,_0x1468c8=>{if(_0x1468c8)throw _0x1468c8;_0x170641[_0xbb78('0xc')](0xc8)['send'](!![]);});}else{fs[_0xbb78('0x1c')](_0x466c49,_0xed71=>{if(_0xed71)throw _0xed71;});_0x170641[_0xbb78('0xc')](0xc8)[_0xbb78('0xd')](![]);}}});router[_0xbb78('0x3')]('/files/upload/publicacion',upload[_0xbb78('0xf')](_0xbb78('0x10')),(_0x2ba87b,_0x4fbf80,_0x39b733)=>{let _0xd6ab73=_0x2ba87b[_0xbb78('0x11')];if(_0xd6ab73==undefined){_0x4fbf80['status'](0xc8)[_0xbb78('0xd')](!![]);}else{let _0x42c37d=_0xd6ab73[_0xbb78('0x1d')];if(_0xd6ab73[_0xbb78('0x12')]/0x400/0x400<=0x1){let _0x40eb42=_0x2ba87b['body'][_0xbb78('0x13')];let _0xaa78dd=_0x2ba87b[_0xbb78('0x6')][_0xbb78('0x7')];let _0x199158=_0xd6ab73[_0xbb78('0x1a')]['replace']('photos',_0xbb78('0x1e'))+_0xbb78('0x1f')+_0x40eb42;fs[_0xbb78('0x1b')](_0x42c37d,_0x199158,_0x5d85b1=>{if(_0x5d85b1){throw _0x5d85b1;}_0x4fbf80['status'](0xc8)[_0xbb78('0xd')](!![]);});}else{fs[_0xbb78('0x1c')](_0x42c37d,_0x45357a=>{if(_0x45357a){throw _0x45357a;}});_0x4fbf80['status'](0xc8)[_0xbb78('0xd')](![]);}}});router['post'](_0xbb78('0x20'),(_0xfffc2e,_0x3c9d87,_0x3abff5)=>{const _0x52d933=JSON['parse'](_0xfffc2e[_0xbb78('0x6')][_0xbb78('0x21')]);const _0x4bd71d=_0x52d933['nombreArchivo'];const _0x29aee3=__dirname+'/public/assets/img/publicaciones/'+_0x4bd71d;fs['unlinkSync'](_0x29aee3);_0x3c9d87['status'](0xc8)[_0xbb78('0xd')](!![]);});router[_0xbb78('0x3')]('/files/copy-file-biometrico',upload[_0xbb78('0xf')](_0xbb78('0x10')),(_0x244482,_0x4d27eb,_0x318605)=>{let _0x11328c=_0x244482['file'];if(_0x11328c==undefined){_0x4d27eb[_0xbb78('0xc')](0xc8)[_0xbb78('0xd')](!![]);}else{let _0x18a003=_0x11328c[_0xbb78('0x1d')];if(_0x11328c[_0xbb78('0x12')]/0x400/0x400<=0x12c){let _0x4d5120=_0x244482['body']['nombreArchivo'];let _0x2ebf34=_0x244482[_0xbb78('0x6')][_0xbb78('0x22')];let _0x5a2dc4=_0x244482['body'][_0xbb78('0x7')];const _0x3f0efc=_0x11328c[_0xbb78('0x1a')][_0xbb78('0x23')](_0xbb78('0x24'),_0xbb78('0x25'))+_0xbb78('0x26')+_0x4d5120+moment(new Date()['getTime']())[_0xbb78('0x27')](_0xbb78('0x28'))+'.'+_0x2ebf34;fs[_0xbb78('0x1b')](_0x18a003,_0x3f0efc,_0x34cd41=>{if(_0x34cd41){throw _0x34cd41;}fs[_0xbb78('0x29')](_0x3f0efc,_0xbb78('0x2a'));_0x4d27eb[_0xbb78('0xc')](0xc8)[_0xbb78('0xd')](!![]);});}else{fs[_0xbb78('0x1c')](_0x18a003,_0x3e6c70=>{if(_0x3e6c70)throw _0x3e6c70;});_0x4d27eb['status'](0xc8)[_0xbb78('0xd')](![]);}}});module[_0xbb78('0x2b')]=router;