var _0x2d9b=['\x5croutes\x5cviajes','platform','/routes/viajes','Workbook','readFile','/fondosenavance.xlsx','then','getWorksheet','AUTORIZACIÃ“N','getRow','getCell','value','commit','format','DD-MM-YYYY','HH:mm:ss','xlsx','writeFile','/fondos-avance/','status','catch','/viajes/get-liquidacion-viajes','body','query','\x0a\x20\x20SELECT\x20li.*,\x0a\x20\x20per.fecha_salida,per.fecha_retorno\x20,\x0a\x20\x20per.observacion,\x0a\x20\x20sp.numero_documento,\x0a\x20\x20sp.nombres,sp.apellido_paterno,sp.apellido_materno,\x0a\x20\x20sp.genero,\x0a\x20\x20sp.fecha_nacimiento,\x0a\x20\x20sp.correo_electronico,\x0a\x20\x20sp.telefono_fijo,\x0a\x20\x20sp.telefono_movil,\x0a\x20\x20sp.estado_civil,\x0a\x20\x20sp.direccion,\x0a\x20\x20sp.departamento_id,\x0a\x20\x20sp.pais_id,\x0a\x20\x20sp.provincia_id,\x0a\x20\x20sp.distrito,\x0a\x20\x20sp.localidad,\x0a\x20\x20sp.licencia_conducir,\x0a\x20\x20sp.autorizacion_formulario_informacion_personal,\x0a\x20\x20de.nombre\x20as\x20departamento,\x0a\x20\x20de2.nombre\x20as\x20departamento_expedido,\x0a\x20\x20un.nombre\x20as\x20unidad,\x0a\x20\x20ar.nombre\x20as\x20area,\x0a\x20\x20ca.nombre\x20as\x20cargo,\x0a\x20\x20re.estado,\x0a\x20\x20es.tipo_contratacion,\x0a\x20\x20ifc.forma_ingreso,\x0a\x20\x20ifc.fecha_inicio,\x0a\x20\x20ifc.fecha_conclusion,\x0a\x20\x20ifc.motivo_conclusion\x0a\x20\x20FROM\x20liquidacion_viajes\x20li\x20INNER\x20JOIN\x20permisos\x20per\x20ON\x20li.permiso_id=per.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INNER\x20JOIN\x20registros\x20re\x20ON\x20per.registro_id\x20=\x20re.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INNER\x20JOIN\x20servidores_publicos\x20sp\x20ON\x20re.servidor_publico_id=sp.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de\x20ON\x20sp.departamento_id=de.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de2\x20ON\x20sp.numero_documento_expedido=de2.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20estructuras\x20es\x20ON\x20es.id=re.estructura_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20escalas_salariales\x20esa\x20ON\x20esa.id=es.escala_salarial_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20cargos\x20ca\x20ON\x20ca.id=esa.cargo_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20unidades\x20un\x20ON\x20un.id=es.unidad_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20inf_contratacion\x20ifc\x20ON\x20re.id=ifc.registro_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20areas\x20ar\x20ON\x20ar.id=un.area_id\x0a\x20\x20\x0a\x20\x20WHERE\x20permiso_id=?\x0a\x20\x20','send','/viajes/update-liquidacion-viajes','liquidacion_via','liquidacion_gastos_mantenimiento_vehiculos','liquidacion_destino_internacional','\x0a\x20\x20UPDATE\x20liquidacion_viajes\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20liquidacion_a=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_via=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_de=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_dias_nacional_urbano=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_viatico_dia_urbano=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_dias_nacional_rural=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_viatico_dia_rural=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_dias_internacional=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_viatico_dia_internacional=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_viatico_dia_internacional_tipo_cambio=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_pasaje_terrestre_ida=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_pasaje_terrestre_retorno=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_pasaje_aereo_ida=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_pasaje_aereo_retorno=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_gastos_tasa_peajes=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_gastos_combustible_lubricantes=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_gastos_mantenimiento_vehiculos=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_destino_nacional=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_destino_internacional=?\x0a\x20\x20WHERE\x20id=?\x0a\x20\x20','affectedRows','exports','express','Router','moment','../../databaseMysql','../../middleware','exceljs','post','/viajes/generar-anexo1','ensureAuthenticated','parse','json','numero_documento','liquidacion_a','nombres','apellido_paterno','apellido_materno','area','unidad','liquidacion_dias_nacional_urbano','liquidacion_viatico_dia_urbano','liquidacion_dias_nacional_rural','liquidacion_viatico_dia_rural','liquidacion_dias_internacional','liquidacion_viatico_dia_internacional','liquidacion_pasaje_terrestre_ida','liquidacion_pasaje_terrestre_retorno','liquidacion_pasaje_aereo_ida','liquidacion_pasaje_aereo_retorno','liquidacion_gastos_tasa_peajes','liquidacion_gastos_combustible_lubricantes','liquidacion_destino_nacional','fecha_salida','observacion','replace'];(function(_0x39e29c,_0x55972d){var _0x39be4f=function(_0x1f7be9){while(--_0x1f7be9){_0x39e29c['push'](_0x39e29c['shift']());}};_0x39be4f(++_0x55972d);}(_0x2d9b,0xea));var _0x505d=function(_0xee81bd,_0x1a48f6){_0xee81bd=_0xee81bd-0x0;var _0xdcf08d=_0x2d9b[_0xee81bd];return _0xdcf08d;};const express=require(_0x505d('0x0'));const router=express[_0x505d('0x1')]();const moment=require(_0x505d('0x2'));const mysqldb=require(_0x505d('0x3'));const middleware=require(_0x505d('0x4'));const os=require('os');const excel=require(_0x505d('0x5'));router[_0x505d('0x6')](_0x505d('0x7'),middleware[_0x505d('0x8')],(_0x4ba05b,_0x29c7dd,_0xab3ffe)=>{const _0x852e50=JSON[_0x505d('0x9')](_0x4ba05b['body'][_0x505d('0xa')]);const _0x214d86=_0x852e50[_0x505d('0xb')];const _0x4d2a9f=_0x852e50[_0x505d('0xc')];const _0x153ec2=_0x852e50['liquidacion_via'];const _0x207599=_0x852e50['liquidacion_de'];const _0x536365=_0x852e50[_0x505d('0xd')];const _0x5ee4d8=_0x852e50[_0x505d('0xe')];const _0x5141b7=_0x852e50[_0x505d('0xf')];const _0x383f6d=_0x852e50['cargo'];const _0xae2f3=_0x852e50[_0x505d('0x10')];const _0x81cabd=_0x852e50[_0x505d('0x11')];const _0x562add=_0x852e50[_0x505d('0x12')];const _0x43850a=_0x852e50[_0x505d('0x13')];const _0x470717=_0x852e50[_0x505d('0x14')];const _0x31ad43=_0x852e50[_0x505d('0x15')];const _0x193f5a=_0x852e50[_0x505d('0x16')];const _0x4285b6=_0x852e50[_0x505d('0x17')];const _0x2c3027=_0x852e50['liquidacion_viatico_dia_internacional_tipo_cambio'];const _0x13c051=_0x852e50[_0x505d('0x18')];const _0x583f97=_0x852e50[_0x505d('0x19')];const _0x55f6ea=_0x852e50[_0x505d('0x1a')];const _0x2ba6a3=_0x852e50[_0x505d('0x1b')];const _0x5b8a41=_0x852e50[_0x505d('0x1c')];const _0x3d2786=_0x852e50[_0x505d('0x1d')];const _0xa48775=_0x852e50['liquidacion_gastos_mantenimiento_vehiculos'];const _0x4609f1=_0x852e50[_0x505d('0x1e')];const _0x28bb69=_0x852e50['liquidacion_destino_internacional'];const _0x1fef7d=_0x852e50[_0x505d('0x1f')];const _0x4e4912=_0x852e50['fecha_retorno'];const _0x60ec6c=_0x852e50[_0x505d('0x20')];let _0x480d80=__dirname[_0x505d('0x21')](_0x505d('0x22'),'')+'\x5cpublic\x5cassets\x5cdocs';let _0x43af3f=os[_0x505d('0x23')]()['toString']();if(_0x43af3f==='linux'){_0x480d80=__dirname[_0x505d('0x21')](_0x505d('0x24'),'')+'/public/assets/docs';}let _0x4dc7c9=new excel[(_0x505d('0x25'))]();_0x4dc7c9['xlsx'][_0x505d('0x26')](_0x480d80+_0x505d('0x27'))[_0x505d('0x28')](()=>{var _0x13c88c=_0x4dc7c9[_0x505d('0x29')](_0x505d('0x2a'));var _0x574c36=_0x13c88c[_0x505d('0x2b')](0x7);_0x574c36[_0x505d('0x2c')]('D')[_0x505d('0x2d')]=_0x4d2a9f;_0x574c36['commit']();_0x574c36=_0x13c88c['getRow'](0x9);_0x574c36['getCell']('D')[_0x505d('0x2d')]=_0x153ec2;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0xb);_0x574c36[_0x505d('0x2c')]('D')[_0x505d('0x2d')]=_0x207599;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c['getRow'](0x12);_0x574c36[_0x505d('0x2c')]('D')[_0x505d('0x2d')]=_0x60ec6c;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c['getRow'](0xf);_0x574c36['getCell']('C')[_0x505d('0x2d')]=_0x536365+'\x20'+_0x5ee4d8+'\x20'+_0x5141b7;_0x574c36[_0x505d('0x2c')]('G')[_0x505d('0x2d')]=''+_0x383f6d;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x10);_0x574c36[_0x505d('0x2c')]('C')[_0x505d('0x2d')]=''+_0xae2f3;_0x574c36['getCell']('G')[_0x505d('0x2d')]=''+_0x81cabd;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x11);_0x574c36['getCell']('C')[_0x505d('0x2d')]='--';_0x574c36['getCell']('G')[_0x505d('0x2d')]='--';_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x13);_0x574c36[_0x505d('0x2c')]('C')['value']=''+_0x4609f1;_0x574c36[_0x505d('0x2c')]('G')['value']=''+_0x28bb69;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x14);_0x574c36['getCell']('C')['value']=''+moment(_0x1fef7d)[_0x505d('0x2f')](_0x505d('0x30'));_0x574c36[_0x505d('0x2c')]('G')[_0x505d('0x2d')]=''+moment(_0x4e4912)[_0x505d('0x2f')](_0x505d('0x30'));_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x15);_0x574c36[_0x505d('0x2c')]('C')[_0x505d('0x2d')]=''+moment(_0x1fef7d)['format'](_0x505d('0x31'));_0x574c36['getCell']('G')[_0x505d('0x2d')]=''+moment(_0x4e4912)[_0x505d('0x2f')](_0x505d('0x31'));_0x574c36['commit']();_0x574c36=_0x13c88c['getRow'](0x19);_0x574c36[_0x505d('0x2c')]('C')[_0x505d('0x2d')]=''+_0x562add;_0x574c36['getCell']('G')[_0x505d('0x2d')]=''+_0x43850a;_0x574c36['commit']();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x1a);_0x574c36[_0x505d('0x2c')]('C')[_0x505d('0x2d')]=''+_0x470717;_0x574c36[_0x505d('0x2c')]('G')['value']=''+_0x31ad43;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x1c);_0x574c36[_0x505d('0x2c')]('C')[_0x505d('0x2d')]=''+_0x470717;_0x574c36[_0x505d('0x2c')]('G')[_0x505d('0x2d')]=''+_0x31ad43;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x1d);_0x574c36[_0x505d('0x2c')]('C')['value']=''+_0x2c3027;_0x574c36['commit']();_0x574c36=_0x13c88c['getRow'](0x23);_0x574c36['getCell']('C')['value']=''+_0x13c051;_0x574c36[_0x505d('0x2c')]('G')[_0x505d('0x2d')]=''+_0x583f97;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x24);_0x574c36[_0x505d('0x2c')]('C')['value']=''+_0x55f6ea;_0x574c36[_0x505d('0x2c')]('G')[_0x505d('0x2d')]=''+_0x2ba6a3;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x2b);_0x574c36[_0x505d('0x2c')]('G')['value']=''+_0x3d2786;_0x574c36[_0x505d('0x2e')]();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x2c);_0x574c36[_0x505d('0x2c')]('G')['value']=''+_0xa48775;_0x574c36['commit']();_0x574c36=_0x13c88c[_0x505d('0x2b')](0x2d);_0x574c36['getCell']('G')['value']=''+_0x5b8a41;_0x574c36[_0x505d('0x2e')]();return _0x4dc7c9[_0x505d('0x32')][_0x505d('0x33')](_0x480d80+_0x505d('0x34')+_0x214d86+'.xlsx');})[_0x505d('0x28')](()=>{_0x29c7dd[_0x505d('0x35')](0xc8)['send']({'success':!![]});})[_0x505d('0x36')](_0x26ea6f=>{throw _0x26ea6f;});});router[_0x505d('0x6')](_0x505d('0x37'),middleware[_0x505d('0x8')],(_0x50e89a,_0x491ab0,_0x1b232e)=>{const _0x345b8a=JSON[_0x505d('0x9')](_0x50e89a[_0x505d('0x38')][_0x505d('0xa')]);const _0x1b9156=_0x345b8a['id'];mysqldb[_0x505d('0x39')](_0x505d('0x3a'),[_0x1b9156],(_0xa491e,_0x1c66a8)=>{if(_0xa491e)throw _0xa491e;_0x491ab0['status'](0xc8)[_0x505d('0x3b')]({'success':_0x1c66a8['length']?!![]:![],'result':_0x1c66a8[0x0]});});});router[_0x505d('0x6')](_0x505d('0x3c'),middleware[_0x505d('0x8')],(_0x3f84f5,_0x4cb931,_0x27ecfe)=>{const _0x45de0d=JSON[_0x505d('0x9')](_0x3f84f5[_0x505d('0x38')][_0x505d('0xa')]);const _0x56d9fc=_0x45de0d['id'];const _0x22e053=_0x45de0d[_0x505d('0xc')];const _0x396d33=_0x45de0d[_0x505d('0x3d')];const _0x4d0476=_0x45de0d['liquidacion_de'];const _0xb0b585=_0x45de0d['liquidacion_dias_nacional_urbano'];const _0x534c21=_0x45de0d['liquidacion_viatico_dia_urbano'];const _0x522468=_0x45de0d[_0x505d('0x14')];const _0x2e5b7b=_0x45de0d['liquidacion_viatico_dia_rural'];const _0x5c8285=_0x45de0d[_0x505d('0x16')];const _0x286382=_0x45de0d[_0x505d('0x17')];const _0x18bcb5=_0x45de0d['liquidacion_viatico_dia_internacional_tipo_cambio'];const _0x1452d2=_0x45de0d['liquidacion_pasaje_terrestre_ida'];const _0x5c820a=_0x45de0d['liquidacion_pasaje_terrestre_retorno'];const _0x3eaa12=_0x45de0d[_0x505d('0x1a')];const _0x5df0ba=_0x45de0d[_0x505d('0x1b')];const _0x3f2583=_0x45de0d['liquidacion_gastos_tasa_peajes'];const _0xbe5e4d=_0x45de0d[_0x505d('0x1d')];const _0xa25401=_0x45de0d[_0x505d('0x3e')];const _0x3e450f=_0x45de0d[_0x505d('0x1e')];const _0x20dc15=_0x45de0d[_0x505d('0x3f')];mysqldb[_0x505d('0x39')](_0x505d('0x40'),[_0x22e053,_0x396d33,_0x4d0476,_0xb0b585,_0x534c21,_0x522468,_0x2e5b7b,_0x5c8285,_0x286382,_0x18bcb5,_0x1452d2,_0x5c820a,_0x3eaa12,_0x5df0ba,_0x3f2583,_0xbe5e4d,_0xa25401,_0x3e450f,_0x20dc15,_0x56d9fc],(_0x171675,_0x4a4a9e)=>{if(_0x171675)throw _0x171675;_0x4cb931['status'](0xc8)[_0x505d('0x3b')]({'success':_0x4a4a9e[_0x505d('0x41')]?!![]:![],'result':_0x4a4a9e});});});module[_0x505d('0x42')]=router;