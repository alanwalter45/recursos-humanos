var _0x4dd9=['xlsx','/fondos-avance/','.xlsx','status','send','catch','post','/viajes/get-liquidacion-viajes','parse','query','liquidacion_dias_internacional','liquidacion_viatico_dia_internacional','liquidacion_pasaje_terrestre_ida','liquidacion_pasaje_aereo_ida','liquidacion_destino_internacional','\x0a\x20\x20UPDATE\x20liquidacion_viajes\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20liquidacion_a=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_via=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_de=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_dias_nacional_urbano=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_viatico_dia_urbano=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_dias_nacional_rural=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_viatico_dia_rural=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_dias_internacional=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_viatico_dia_internacional=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_viatico_dia_internacional_tipo_cambio=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_pasaje_terrestre_ida=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_pasaje_terrestre_retorno=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_pasaje_aereo_ida=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_pasaje_aereo_retorno=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_gastos_tasa_peajes=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_gastos_combustible_lubricantes=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_gastos_mantenimiento_vehiculos=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_destino_nacional=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20liquidacion_destino_internacional=?\x0a\x20\x20WHERE\x20id=?\x0a\x20\x20','exports','express','Router','moment','../../databaseMysql','../../middleware','exceljs','/viajes/generar-anexo1','ensureAuthenticated','body','json','numero_documento','liquidacion_a','liquidacion_via','liquidacion_de','nombres','apellido_paterno','apellido_materno','area','unidad','liquidacion_dias_nacional_urbano','liquidacion_viatico_dia_urbano','liquidacion_dias_nacional_rural','liquidacion_viatico_dia_rural','liquidacion_viatico_dia_internacional_tipo_cambio','liquidacion_pasaje_terrestre_retorno','liquidacion_pasaje_aereo_retorno','liquidacion_gastos_tasa_peajes','liquidacion_gastos_combustible_lubricantes','liquidacion_gastos_mantenimiento_vehiculos','liquidacion_destino_nacional','fecha_salida','fecha_retorno','observacion','replace','\x5croutes\x5cviajes','\x5cpublic\x5cassets\x5cdocs','toString','/routes/viajes','Workbook','readFile','/fondosenavance.xlsx','then','AUTORIZACIÃ“N','getRow','value','commit','getCell','format','DD-MM-YYYY','HH:mm:ss'];(function(_0x34cd58,_0x452097){var _0x11ea57=function(_0x1840c6){while(--_0x1840c6){_0x34cd58['push'](_0x34cd58['shift']());}};_0x11ea57(++_0x452097);}(_0x4dd9,0xda));var _0x1968=function(_0xd97658,_0x57a9b9){_0xd97658=_0xd97658-0x0;var _0x52e36f=_0x4dd9[_0xd97658];return _0x52e36f;};const express=require(_0x1968('0x0'));const router=express[_0x1968('0x1')]();const moment=require(_0x1968('0x2'));const mysqldb=require(_0x1968('0x3'));const middleware=require(_0x1968('0x4'));const os=require('os');const excel=require(_0x1968('0x5'));router['post'](_0x1968('0x6'),middleware[_0x1968('0x7')],(_0x1a9d6c,_0x31b68e,_0x3b6cb0)=>{const _0x1b82b5=JSON['parse'](_0x1a9d6c[_0x1968('0x8')][_0x1968('0x9')]);const _0xdf6d2=_0x1b82b5[_0x1968('0xa')];const _0x568a2e=_0x1b82b5[_0x1968('0xb')];const _0x2ce7d3=_0x1b82b5[_0x1968('0xc')];const _0xc1c0bd=_0x1b82b5[_0x1968('0xd')];const _0x50d43d=_0x1b82b5[_0x1968('0xe')];const _0x33b58f=_0x1b82b5[_0x1968('0xf')];const _0x162f38=_0x1b82b5[_0x1968('0x10')];const _0x4877ce=_0x1b82b5['cargo'];const _0x4ff955=_0x1b82b5[_0x1968('0x11')];const _0x7bd9=_0x1b82b5[_0x1968('0x12')];const _0x440050=_0x1b82b5[_0x1968('0x13')];const _0x253f28=_0x1b82b5[_0x1968('0x14')];const _0x5286da=_0x1b82b5[_0x1968('0x15')];const _0x476487=_0x1b82b5[_0x1968('0x16')];const _0x1c1cca=_0x1b82b5['liquidacion_dias_internacional'];const _0x2f3ad1=_0x1b82b5['liquidacion_viatico_dia_internacional'];const _0x315b4=_0x1b82b5[_0x1968('0x17')];const _0x469221=_0x1b82b5['liquidacion_pasaje_terrestre_ida'];const _0x5eeee9=_0x1b82b5[_0x1968('0x18')];const _0x17e224=_0x1b82b5['liquidacion_pasaje_aereo_ida'];const _0x3ac7f2=_0x1b82b5[_0x1968('0x19')];const _0x656650=_0x1b82b5[_0x1968('0x1a')];const _0x339b24=_0x1b82b5[_0x1968('0x1b')];const _0x3d444f=_0x1b82b5[_0x1968('0x1c')];const _0x5551ac=_0x1b82b5[_0x1968('0x1d')];const _0x5ea244=_0x1b82b5['liquidacion_destino_internacional'];const _0x2d6c07=_0x1b82b5[_0x1968('0x1e')];const _0x152960=_0x1b82b5[_0x1968('0x1f')];const _0x35a2c4=_0x1b82b5[_0x1968('0x20')];let _0x5665bc=__dirname[_0x1968('0x21')](_0x1968('0x22'),'')+_0x1968('0x23');let _0x38450c=os['platform']()[_0x1968('0x24')]();if(_0x38450c==='linux'){_0x5665bc=__dirname[_0x1968('0x21')](_0x1968('0x25'),'')+'/public/assets/docs';}let _0x40f7a5=new excel[(_0x1968('0x26'))]();_0x40f7a5['xlsx'][_0x1968('0x27')](_0x5665bc+_0x1968('0x28'))[_0x1968('0x29')](()=>{var _0x2b129a=_0x40f7a5['getWorksheet'](_0x1968('0x2a'));var _0x107655=_0x2b129a[_0x1968('0x2b')](0x7);_0x107655['getCell']('D')[_0x1968('0x2c')]=_0x568a2e;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x9);_0x107655[_0x1968('0x2e')]('D')[_0x1968('0x2c')]=_0x2ce7d3;_0x107655['commit']();_0x107655=_0x2b129a['getRow'](0xb);_0x107655[_0x1968('0x2e')]('D')[_0x1968('0x2c')]=_0xc1c0bd;_0x107655['commit']();_0x107655=_0x2b129a['getRow'](0x12);_0x107655[_0x1968('0x2e')]('D')['value']=_0x35a2c4;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0xf);_0x107655[_0x1968('0x2e')]('C')[_0x1968('0x2c')]=_0x50d43d+'\x20'+_0x33b58f+'\x20'+_0x162f38;_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]=''+_0x4877ce;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x10);_0x107655['getCell']('C')[_0x1968('0x2c')]=''+_0x4ff955;_0x107655['getCell']('G')[_0x1968('0x2c')]=''+_0x7bd9;_0x107655['commit']();_0x107655=_0x2b129a['getRow'](0x11);_0x107655['getCell']('C')[_0x1968('0x2c')]='--';_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]='--';_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x13);_0x107655[_0x1968('0x2e')]('C')['value']=''+_0x5551ac;_0x107655[_0x1968('0x2e')]('G')['value']=''+_0x5ea244;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x14);_0x107655[_0x1968('0x2e')]('C')[_0x1968('0x2c')]=''+moment(_0x2d6c07)[_0x1968('0x2f')]('DD-MM-YYYY');_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]=''+moment(_0x152960)[_0x1968('0x2f')](_0x1968('0x30'));_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x15);_0x107655[_0x1968('0x2e')]('C')[_0x1968('0x2c')]=''+moment(_0x2d6c07)[_0x1968('0x2f')](_0x1968('0x31'));_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]=''+moment(_0x152960)[_0x1968('0x2f')](_0x1968('0x31'));_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a['getRow'](0x19);_0x107655['getCell']('C')[_0x1968('0x2c')]=''+_0x440050;_0x107655[_0x1968('0x2e')]('G')['value']=''+_0x253f28;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x1a);_0x107655['getCell']('C')[_0x1968('0x2c')]=''+_0x5286da;_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]=''+_0x476487;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x1c);_0x107655[_0x1968('0x2e')]('C')[_0x1968('0x2c')]=''+_0x5286da;_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]=''+_0x476487;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x1d);_0x107655[_0x1968('0x2e')]('C')[_0x1968('0x2c')]=''+_0x315b4;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a[_0x1968('0x2b')](0x23);_0x107655['getCell']('C')[_0x1968('0x2c')]=''+_0x469221;_0x107655['getCell']('G')[_0x1968('0x2c')]=''+_0x5eeee9;_0x107655['commit']();_0x107655=_0x2b129a[_0x1968('0x2b')](0x24);_0x107655['getCell']('C')[_0x1968('0x2c')]=''+_0x17e224;_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]=''+_0x3ac7f2;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a['getRow'](0x2b);_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]=''+_0x339b24;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a['getRow'](0x2c);_0x107655[_0x1968('0x2e')]('G')[_0x1968('0x2c')]=''+_0x3d444f;_0x107655[_0x1968('0x2d')]();_0x107655=_0x2b129a['getRow'](0x2d);_0x107655[_0x1968('0x2e')]('G')['value']=''+_0x656650;_0x107655[_0x1968('0x2d')]();return _0x40f7a5[_0x1968('0x32')]['writeFile'](_0x5665bc+_0x1968('0x33')+_0xdf6d2+_0x1968('0x34'));})['then'](()=>{_0x31b68e[_0x1968('0x35')](0xc8)[_0x1968('0x36')]({'success':!![]});})[_0x1968('0x37')](_0x563750=>{throw _0x563750;});});router[_0x1968('0x38')](_0x1968('0x39'),middleware['ensureAuthenticated'],(_0x233be8,_0x4c4a66,_0x1b941f)=>{const _0x23b4a6=JSON[_0x1968('0x3a')](_0x233be8[_0x1968('0x8')][_0x1968('0x9')]);const _0x607b3c=_0x23b4a6['id'];mysqldb[_0x1968('0x3b')]('\x0a\x20\x20SELECT\x20li.*,\x0a\x20\x20per.fecha_salida,per.fecha_retorno\x20,\x0a\x20\x20per.observacion,\x0a\x20\x20sp.numero_documento,\x0a\x20\x20sp.nombres,sp.apellido_paterno,sp.apellido_materno,\x0a\x20\x20sp.genero,\x0a\x20\x20sp.fecha_nacimiento,\x0a\x20\x20sp.correo_electronico,\x0a\x20\x20sp.telefono_fijo,\x0a\x20\x20sp.telefono_movil,\x0a\x20\x20sp.estado_civil,\x0a\x20\x20sp.direccion,\x0a\x20\x20sp.departamento_id,\x0a\x20\x20sp.pais_id,\x0a\x20\x20sp.provincia_id,\x0a\x20\x20sp.distrito,\x0a\x20\x20sp.localidad,\x0a\x20\x20sp.licencia_conducir,\x0a\x20\x20sp.autorizacion_formulario_informacion_personal,\x0a\x20\x20de.nombre\x20as\x20departamento,\x0a\x20\x20de2.nombre\x20as\x20departamento_expedido,\x0a\x20\x20un.nombre\x20as\x20unidad,\x0a\x20\x20ar.nombre\x20as\x20area,\x0a\x20\x20ca.nombre\x20as\x20cargo,\x0a\x20\x20re.estado,\x0a\x20\x20es.tipo_contratacion,\x0a\x20\x20ifc.forma_ingreso,\x0a\x20\x20ifc.fecha_inicio,\x0a\x20\x20ifc.fecha_conclusion,\x0a\x20\x20ifc.motivo_conclusion\x0a\x20\x20FROM\x20liquidacion_viajes\x20li\x20INNER\x20JOIN\x20permisos\x20per\x20ON\x20li.permiso_id=per.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INNER\x20JOIN\x20registros\x20re\x20ON\x20per.registro_id\x20=\x20re.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INNER\x20JOIN\x20servidores_publicos\x20sp\x20ON\x20re.servidor_publico_id=sp.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de\x20ON\x20sp.departamento_id=de.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de2\x20ON\x20sp.numero_documento_expedido=de2.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20estructuras\x20es\x20ON\x20es.id=re.estructura_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20escalas_salariales\x20esa\x20ON\x20esa.id=es.escala_salarial_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20cargos\x20ca\x20ON\x20ca.id=esa.cargo_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20unidades\x20un\x20ON\x20un.id=es.unidad_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20inf_contratacion\x20ifc\x20ON\x20re.id=ifc.registro_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20areas\x20ar\x20ON\x20ar.id=un.area_id\x0a\x0a\x20\x20WHERE\x20permiso_id=?\x0a\x20\x20',[_0x607b3c],(_0xcc6c75,_0x419507)=>{if(_0xcc6c75)throw _0xcc6c75;_0x4c4a66[_0x1968('0x35')](0xc8)['send']({'success':_0x419507['length']?!![]:![],'result':_0x419507[0x0]});});});router[_0x1968('0x38')]('/viajes/update-liquidacion-viajes',middleware[_0x1968('0x7')],(_0x35c4e9,_0x3bbb69,_0x1adbf4)=>{const _0x2accf6=JSON[_0x1968('0x3a')](_0x35c4e9[_0x1968('0x8')][_0x1968('0x9')]);const _0x2de1bc=_0x2accf6['id'];const _0x432a52=_0x2accf6[_0x1968('0xb')];const _0x16b9e6=_0x2accf6[_0x1968('0xc')];const _0x295138=_0x2accf6[_0x1968('0xd')];const _0x267fc8=_0x2accf6[_0x1968('0x13')];const _0xed02b5=_0x2accf6[_0x1968('0x14')];const _0x2dcaaa=_0x2accf6[_0x1968('0x15')];const _0x19568f=_0x2accf6['liquidacion_viatico_dia_rural'];const _0xa399d9=_0x2accf6[_0x1968('0x3c')];const _0x2d3431=_0x2accf6[_0x1968('0x3d')];const _0x5c0cd1=_0x2accf6['liquidacion_viatico_dia_internacional_tipo_cambio'];const _0xe6c004=_0x2accf6[_0x1968('0x3e')];const _0xf73dd5=_0x2accf6[_0x1968('0x18')];const _0x375c37=_0x2accf6[_0x1968('0x3f')];const _0x14c0bf=_0x2accf6[_0x1968('0x19')];const _0xa0a644=_0x2accf6[_0x1968('0x1a')];const _0x4ff70f=_0x2accf6[_0x1968('0x1b')];const _0x5cd045=_0x2accf6[_0x1968('0x1c')];const _0x1e1fff=_0x2accf6[_0x1968('0x1d')];const _0x4ea81b=_0x2accf6[_0x1968('0x40')];mysqldb[_0x1968('0x3b')](_0x1968('0x41'),[_0x432a52,_0x16b9e6,_0x295138,_0x267fc8,_0xed02b5,_0x2dcaaa,_0x19568f,_0xa399d9,_0x2d3431,_0x5c0cd1,_0xe6c004,_0xf73dd5,_0x375c37,_0x14c0bf,_0xa0a644,_0x4ff70f,_0x5cd045,_0x1e1fff,_0x4ea81b,_0x2de1bc],(_0x2fdcb3,_0x2eeb4d)=>{if(_0x2fdcb3)throw _0x2fdcb3;_0x3bbb69[_0x1968('0x35')](0xc8)[_0x1968('0x36')]({'success':_0x2eeb4d['affectedRows']?!![]:![],'result':_0x2eeb4d});});});module[_0x1968('0x42')]=router;