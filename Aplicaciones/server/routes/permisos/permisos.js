var _0x1a02=['status','send','parse','body','servidor_publico_id','\x0a\x20\x20\x0a\x20\x20SELECT\x20\x0a\x20\x20\x20\x20per.id,\x0a\x20\x20\x20\x20per.observacion,\x0a\x20\x20\x20\x20per.estado\x20as\x20estado_permiso,\x0a\x20\x20\x20\x20per.tipo,\x0a\x20\x20\x20\x20per.fecha_salida,\x0a\x20\x20\x20\x20per.fecha_retorno,\x0a\x20\x20\x20\x20per.fecha_modificacion,\x0a\x20\x20\x20\x20per.observacion\x20as\x20observacion_permiso,\x0a\x20\x20\x20\x20per.estado,\x0a\x20\x20\x20\x20sp.nombres,\x0a\x20\x20\x20\x20sp.apellido_paterno,\x0a\x20\x20\x20\x20sp.apellido_materno,\x0a\x20\x20\x20\x20ca.nombre\x20as\x20cargo,\x0a\x20\x20\x20\x20un.nombre\x20as\x20unidad,\x0a\x20\x20\x20\x20ar.nombre\x20as\x20area\x0a\x20\x20\x20\x20FROM\x20registros\x20re\x20INNER\x20JOIN\x20servidores_publicos\x20sp\x20ON\x20re.servidor_publico_id=sp.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de\x20ON\x20sp.departamento_id=de.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de2\x20ON\x20sp.numero_documento_expedido=de2.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20estructuras\x20es\x20ON\x20es.id=re.estructura_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20escalas_salariales\x20esa\x20ON\x20esa.id=es.escala_salarial_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20cargos\x20ca\x20ON\x20ca.id=esa.cargo_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20unidades\x20un\x20ON\x20un.id=es.unidad_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20inf_contratacion\x20ifc\x20ON\x20re.id=ifc.registro_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20areas\x20ar\x20ON\x20ar.id=un.area_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INNER\x20JOIN\x20permisos\x20per\x20ON\x20per.registro_id=re.id\x0a\x20\x20\x20\x20WHERE\x20per.registro_id\x20IN\x20(SELECT\x20id\x20from\x20registros\x20where\x20servidor_publico_id=?)\x0a\x20\x20\x20\x20ORDER\x20BY\x20fecha_salida\x20DESC\x0a\x20\x20\x20\x20LIMIT\x20700;\x0a\x20\x20','post','ensureAuthenticated','json','\x0a\x20\x0a\x20\x20SELECT\x20\x0a\x20\x20per.id,\x0a\x20\x20sp.id\x20as\x20servidor_publico_id,\x0a\x20\x20sp.numero_documento,\x0a\x20\x20sp.nombres,sp.apellido_paterno,sp.apellido_materno,\x0a\x20\x20sp.genero,\x0a\x20\x20sp.fecha_nacimiento,\x0a\x20\x20sp.correo_electronico,\x0a\x20\x20sp.telefono_fijo,\x0a\x20\x20sp.telefono_movil,\x0a\x20\x20sp.estado_civil,\x0a\x20\x20sp.direccion,\x0a\x20\x20sp.departamento_id,\x0a\x20\x20sp.pais_id,\x0a\x20\x20sp.provincia_id,\x0a\x20\x20sp.distrito,\x0a\x20\x20sp.localidad,\x0a\x20\x20sp.licencia_conducir,\x0a\x20\x20de.nombre\x20as\x20departamento,\x0a\x20\x20de2.nombre\x20as\x20departamento_expedido,\x0a\x20\x20un.nombre\x20as\x20unidad,\x0a\x20\x20ar.nombre\x20as\x20area,\x0a\x20\x20ca.nombre\x20as\x20cargo,\x0a\x20\x20re.estado,\x0a\x20\x20es.tipo_contratacion,\x0a\x20\x20ifc.forma_ingreso,\x0a\x20\x20ifc.fecha_inicio,\x0a\x20\x20ifc.fecha_conclusion,\x0a\x20\x20ifc.motivo_conclusion,\x0a\x20\x20re.id\x20as\x20registro_id,\x0a\x20\x20re.observado,\x0a\x20\x20es.numero,\x0a\x20\x20es.id\x20as\x20estructura_id,\x0a\x20\x20cat.codigo\x20as\x20categoria_programatica_id,\x0a\x20\x20sp.codigo_biometrico,\x0a\x20\x20per.fecha_salida\x20as\x20fecha_salida_permiso,\x0a\x20\x20per.fecha_retorno\x20as\x20fecha_retorno_permiso,\x0a\x20\x20per.observacion\x20as\x20observacion_permiso,\x0a\x20\x20per.tipo\x20as\x20tipo_permiso,\x0a\x20\x20per.estado\x20as\x20estado_permiso\x0a\x20\x20FROM\x20registros\x20re\x20INNER\x20JOIN\x20servidores_publicos\x20sp\x20ON\x20re.servidor_publico_id=sp.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de\x20ON\x20sp.departamento_id=de.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de2\x20ON\x20sp.numero_documento_expedido=de2.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20estructuras\x20es\x20ON\x20es.id=re.estructura_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20escalas_salariales\x20esa\x20ON\x20esa.id=es.escala_salarial_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20cargos\x20ca\x20ON\x20ca.id=esa.cargo_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20unidades\x20un\x20ON\x20un.id=es.unidad_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20inf_contratacion\x20ifc\x20ON\x20re.id=ifc.registro_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20areas\x20ar\x20ON\x20ar.id=un.area_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20categorias_programaticas\x20cat\x20ON\x20cat.id=es.categoria_programatica_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INNER\x20JOIN\x20permisos\x20per\x20ON\x20per.registro_id=re.id\x0a\x20\x20WHERE\x20re.mes_id\x20=(select\x20id\x20from\x20meses\x20where\x20selected=1)\x0a\x20\x20AND\x20un.id=(select\x20unidad_id\x20from\x20registros\x20re\x20inner\x20join\x20estructuras\x20es\x20on\x20\x20re.estructura_id=es.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20where\x20re.mes_id\x20=(select\x20id\x20from\x20meses\x20where\x20selected=1)\x20and\x20re.servidor_publico_id=?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x0a\x20\x20ORDER\x20BY\x20es.numero\x20asc\x0a\x20\x0a\x20\x20','length','/permisos/agregar','fechaHoraRetorno','format','YYYY-MM-DD\x20HH:mm:ss','estado','observacion','CALL\x20add_formulario_permiso(?,?,?,?,?,?,?)','VIAJE','SELECT\x20*\x20from\x20permisos\x20WHERE\x20fecha_salida=?\x20AND\x20fecha_retorno=?\x20AND\x20registro_id=?','INSERT\x20INTO\x20programaciones_mensuales_viajes(fecha_modificacion,permiso_id)\x20values(?,?)','INSERT\x20INTO\x20liquidacion_viajes(fecha_modificacion,permiso_id)\x20values(?,?)','affectedRows','/permisos/actualizar-estado','permiso_id','motivo_cambio_estado','UPDATE\x20permisos\x20SET\x20estado=?\x20,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20motivo_cambio_estado=?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id=?','exports','express','Router','./../../databaseMysql','./../../middleware','get','query','\x0a\x20\x20SELECT\x0a\x20\x20per.id,\x0a\x20\x20\x20\x20per.observacion,\x0a\x20\x20\x20\x20per.estado\x20as\x20estado_permiso,\x0a\x20\x20\x20\x20per.tipo,\x0a\x20\x20\x20\x20per.fecha_salida,\x0a\x20\x20\x20\x20per.fecha_retorno,\x0a\x20\x20\x20\x20per.fecha_modificacion,\x0a\x20\x20\x20\x20per.observacion\x20as\x20observacion_permiso,\x0a\x20\x20\x20\x20per.estado,\x0a\x20\x20\x20\x20sp.nombres,\x0a\x20\x20\x20\x20sp.apellido_paterno,\x0a\x20\x20\x20\x20sp.apellido_materno,\x0a\x20\x20\x20\x20ca.nombre\x20as\x20cargo,\x0a\x20\x20\x20\x20un.nombre\x20as\x20unidad,\x0a\x20\x20\x20\x20ar.nombre\x20as\x20area\x0a\x20\x20\x20\x20FROM\x20registros\x20re\x20INNER\x20JOIN\x20servidores_publicos\x20sp\x20ON\x20re.servidor_publico_id=sp.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de\x20ON\x20sp.departamento_id=de.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20departamentos\x20de2\x20ON\x20sp.numero_documento_expedido=de2.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20estructuras\x20es\x20ON\x20es.id=re.estructura_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20escalas_salariales\x20esa\x20ON\x20esa.id=es.escala_salarial_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20cargos\x20ca\x20ON\x20ca.id=esa.cargo_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20unidades\x20un\x20ON\x20un.id=es.unidad_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20inf_contratacion\x20ifc\x20ON\x20re.id=ifc.registro_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20areas\x20ar\x20ON\x20ar.id=un.area_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INNER\x20JOIN\x20permisos\x20per\x20ON\x20per.registro_id=re.id\x0a\x20\x20\x20\x20ORDER\x20BY\x20fecha_salida\x20DESC\x0a\x20\x20\x20\x20LIMIT\x20700;'];(function(_0x3673e6,_0x48d0ce){var _0x3d0f77=function(_0x3e58cb){while(--_0x3e58cb){_0x3673e6['push'](_0x3673e6['shift']());}};_0x3d0f77(++_0x48d0ce);}(_0x1a02,0x1c0));var _0x2492=function(_0x15af67,_0x26db21){_0x15af67=_0x15af67-0x0;var _0x44a20c=_0x1a02[_0x15af67];return _0x44a20c;};'use strict';const express=require(_0x2492('0x0'));const router=express[_0x2492('0x1')]();const moment=require('moment');const mysqldb=require(_0x2492('0x2'));const middleware=require(_0x2492('0x3'));router[_0x2492('0x4')]('/permisos/all',middleware['ensureAuthenticated'],(_0xe42b77,_0x56465b,_0x52cace)=>{mysqldb[_0x2492('0x5')](_0x2492('0x6'),(_0x307b3e,_0x3ab53f)=>{if(_0x307b3e){throw _0x307b3e;}_0x56465b[_0x2492('0x7')](0xc8)[_0x2492('0x8')]({'success':_0x3ab53f['length']?!![]:![],'result':_0x3ab53f});});});router['post']('/permisos/servant',middleware['ensureAuthenticated'],(_0x273d4d,_0x36471c,_0xd5b662)=>{let _0x26d672=JSON[_0x2492('0x9')](_0x273d4d[_0x2492('0xa')]['json']);let _0x4283ce=_0x26d672[_0x2492('0xb')];mysqldb[_0x2492('0x5')](_0x2492('0xc'),[_0x4283ce],function(_0x44dcfd,_0x4d5611){if(_0x44dcfd)throw _0x44dcfd;_0x36471c['status'](0xc8)[_0x2492('0x8')]({'success':_0x4d5611['length']?!![]:![],'result':_0x4d5611});});});router[_0x2492('0xd')]('/permisos/servants-dependientes',middleware[_0x2492('0xe')],(_0x12066b,_0x48f32d,_0x225616)=>{let _0x5a0a06=JSON[_0x2492('0x9')](_0x12066b[_0x2492('0xa')][_0x2492('0xf')]);let _0x205fd6=_0x5a0a06[_0x2492('0xb')];mysqldb[_0x2492('0x5')](_0x2492('0x10'),[_0x205fd6],function(_0x20559e,_0x1314ae){if(_0x20559e)throw _0x20559e;_0x48f32d[_0x2492('0x7')](0xc8)[_0x2492('0x8')]({'success':_0x1314ae[_0x2492('0x11')]?!![]:![],'result':_0x1314ae});});});router['post'](_0x2492('0x12'),middleware[_0x2492('0xe')],(_0x53682f,_0x20f109,_0x5a09ef)=>{let _0x588269=JSON[_0x2492('0x9')](_0x53682f[_0x2492('0xa')][_0x2492('0xf')]);const _0x30bae6=_0x588269['fechaHoraSalida'];const _0xfb6e48=_0x588269[_0x2492('0x13')];let _0x3b45bc=moment(_0x30bae6)[_0x2492('0x14')](_0x2492('0x15'));let _0x42ac8f=moment(_0xfb6e48)[_0x2492('0x14')]('YYYY-MM-DD\x20HH:mm:ss');let _0x59181e=_0x588269[_0x2492('0x16')];let _0x3a8e58=_0x588269[_0x2492('0x17')];let _0x33161b=_0x588269['tipo'];let _0x384319=_0x588269['registro_id'];let _0x45a1e7=new Date();mysqldb['query'](_0x2492('0x18'),[_0x384319,_0x3b45bc,_0x42ac8f,_0x33161b,_0x59181e,_0x3a8e58,_0x45a1e7],function(_0x34dc65,_0x25fba9){if(_0x34dc65)throw _0x34dc65;if(_0x33161b==_0x2492('0x19')){mysqldb[_0x2492('0x5')](_0x2492('0x1a'),[_0x3b45bc,_0x42ac8f,_0x384319],(_0x11c3b6,_0x14de77)=>{if(_0x11c3b6)throw _0x11c3b6;mysqldb['query'](_0x2492('0x1b'),[_0x45a1e7,_0x14de77[0x0]['id']],_0x468813=>{if(_0x468813)throw _0x468813;mysqldb[_0x2492('0x5')](_0x2492('0x1c'),[_0x45a1e7,_0x14de77[0x0]['id']],(_0x5c877d,_0x15b200)=>{if(_0x5c877d)throw _0x5c877d;_0x20f109[_0x2492('0x7')](0xc8)[_0x2492('0x8')]({'success':_0x15b200[_0x2492('0x1d')]?!![]:![]});});});});}else{_0x20f109[_0x2492('0x7')](0xc8)[_0x2492('0x8')]({'success':_0x25fba9[_0x2492('0x1d')]?!![]:![]});}});});router[_0x2492('0xd')](_0x2492('0x1e'),middleware['ensureAuthenticated'],(_0x426950,_0x5d1e0e,_0x2407f9)=>{let _0x3ae878=JSON[_0x2492('0x9')](_0x426950[_0x2492('0xa')][_0x2492('0xf')]);let _0x5180f1=_0x3ae878[_0x2492('0x16')];let _0x46f0a5=_0x3ae878[_0x2492('0x1f')];let _0x2da5c0=_0x3ae878[_0x2492('0x20')];mysqldb[_0x2492('0x5')](_0x2492('0x21'),[_0x5180f1,_0x2da5c0,_0x46f0a5],function(_0x39e565,_0x5583a4){if(_0x39e565)throw _0x39e565;_0x5d1e0e[_0x2492('0x7')](0xc8)['send']({'success':_0x5583a4[_0x2492('0x1d')]?!![]:![]});});});module[_0x2492('0x22')]=router;