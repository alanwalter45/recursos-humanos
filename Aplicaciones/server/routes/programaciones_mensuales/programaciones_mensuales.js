var _0x2f10=['/programaciones-mensuales/add-actividad','parse','json','registro_id','fecha','lugar','toString','actividad','toUpperCase','format','YYYY-MM-DD\x20HH:mm:ss','\x0a\x20\x20INSERT\x20INTO\x20programaciones_mensuales(fecha,\x20lugar,\x20actividad,\x20producto,\x20registro_id,\x20fecha_modificacion)\x0a\x20\x20select\x20?,?,?,?,?,?\x0a\x20\x20WHERE\x20NOT\x20EXISTS(SELECT\x20*\x20FROM\x20programaciones_mensuales\x0a\x20\x20\x20\x20WHERE\x20registro_id=?\x20and\x20fecha=?\x20and\x20actividad=?)','status','send','affectedRows','/programaciones-mensuales/edit-actividad','ensureAuthenticated','YYYY-MM-DD','producto','cumplimiento_ejecucion','query','\x0a\x20\x20UPDATE\x20programaciones_mensuales\x20SET\x20fecha=?,\x20lugar=?,\x20actividad=?,\x20producto=?,\x20fecha_modificacion=?,\x20cumplimiento_ejecucion=?\x0a\x20\x20WHERE\x20id=?','body','\x0a\x20\x20SELECT\x20pm.*\x20from\x20programaciones_mensuales\x20pm\x20left\x20join\x20registros\x20re\x20on\x20pm.registro_id=re.id\x0a\x20\x20where\x20pm.registro_id=?\x20AND\x20date_format(pm.fecha_modificacion,\x27%m\x27)=date_format(now(),\x27%m\x27)','length','INSERT\x20INTO\x20programaciones_mensuales(registro_id,\x20fecha_modificacion)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20','get','/programaciones-mensuales/get-all','/programaciones-mensuales/exportar','numero_documento','nombres','apellido_paterno','apellido_materno','cargo','nivel','secretaria','direccion_jefatura','relacion_laboral','numero','aclaracion_cambio_area','objetivo_cargo','fecha_elaboracion_sp','productos','replace','\x5cpublic\x5cassets\x5cdocs\x5c','programaciones-mensuales\x5c','linux','/public/assets/docs/','/programaciones-mensuales/','binary','setData','render','message','name','stack','properties','log','stringify','generate','nodebuffer','writeFileSync','.docx','express','Router','moment','./../../databaseMysql','./../../middleware','jszip','docxtemplater','path','post'];(function(_0x5a9aad,_0x6d3366){var _0x4b32cd=function(_0x4a5e18){while(--_0x4a5e18){_0x5a9aad['push'](_0x5a9aad['shift']());}};_0x4b32cd(++_0x6d3366);}(_0x2f10,0x113));var _0x5546=function(_0x3430ca,_0x1848c1){_0x3430ca=_0x3430ca-0x0;var _0x427afd=_0x2f10[_0x3430ca];return _0x427afd;};const express=require(_0x5546('0x0'));const router=express[_0x5546('0x1')]();const moment=require(_0x5546('0x2'));const mysqldb=require(_0x5546('0x3'));const middleware=require(_0x5546('0x4'));var JSZip=require(_0x5546('0x5'));var Docxtemplater=require(_0x5546('0x6'));var fs=require('fs');var path=require(_0x5546('0x7'));const os=require('os');router[_0x5546('0x8')](_0x5546('0x9'),middleware['ensureAuthenticated'],(_0x576ef9,_0x3c01cd,_0x497b8a)=>{const _0x11788d=JSON[_0x5546('0xa')](_0x576ef9['body'][_0x5546('0xb')]);const _0x76b586=_0x11788d[_0x5546('0xc')];const _0x5e448d=_0x11788d[_0x5546('0xd')];const _0x42fab7=_0x11788d[_0x5546('0xe')][_0x5546('0xf')]()['toUpperCase']();const _0x23febf=_0x11788d['producto'];const _0x25e1d5=_0x11788d[_0x5546('0x10')][_0x5546('0xf')]()[_0x5546('0x11')]();const _0x2ac893=moment(new Date())[_0x5546('0x12')](_0x5546('0x13'));mysqldb['query'](_0x5546('0x14'),[_0x5e448d,_0x42fab7,_0x25e1d5,_0x23febf,_0x76b586,_0x2ac893,_0x76b586,_0x5e448d,_0x25e1d5],function(_0x568b83,_0x1f36b6){if(_0x568b83)throw _0x568b83;_0x3c01cd[_0x5546('0x15')](0xc8)[_0x5546('0x16')]({'success':_0x1f36b6[_0x5546('0x17')]?!![]:![],'result':_0x1f36b6[_0x5546('0x17')]});});});router['post'](_0x5546('0x18'),middleware[_0x5546('0x19')],(_0x262ca9,_0x2bce13,_0x299827)=>{const _0x22e611=JSON['parse'](_0x262ca9['body']['json']);const _0x4e3d0a=_0x22e611['id'];const _0x4a6601=_0x22e611[_0x5546('0xd')]?moment(_0x22e611[_0x5546('0xd')])[_0x5546('0x12')](_0x5546('0x1a')):null;const _0x22ebd4=_0x22e611[_0x5546('0xe')]?_0x22e611[_0x5546('0xe')][_0x5546('0xf')]()[_0x5546('0x11')]():'';const _0x2deecb=_0x22e611[_0x5546('0x1b')]?_0x22e611[_0x5546('0x1b')]:'';const _0x3b4ece=_0x22e611[_0x5546('0x10')]?_0x22e611[_0x5546('0x10')]['toString']()[_0x5546('0x11')]():'';const _0x16c55b=_0x22e611[_0x5546('0x1c')]?_0x22e611[_0x5546('0x1c')][_0x5546('0xf')]():'';const _0x251315=moment(new Date())[_0x5546('0x12')]('YYYY-MM-DD\x20HH:mm:ss');mysqldb[_0x5546('0x1d')](_0x5546('0x1e'),[_0x4a6601,_0x22ebd4,_0x3b4ece,_0x2deecb,_0x251315,_0x16c55b,_0x4e3d0a],function(_0x2e217a,_0x54ff7e){if(_0x2e217a)throw _0x2e217a;_0x2bce13['status'](0xc8)[_0x5546('0x16')]({'success':_0x54ff7e[_0x5546('0x17')]?!![]:![],'result':_0x54ff7e['affectedRows']});});});router['post']('/programaciones-mensuales/get-programacion-mensual-registro',middleware[_0x5546('0x19')],(_0x5c7e58,_0x10b916,_0xdd6221)=>{const _0x49ea81=JSON[_0x5546('0xa')](_0x5c7e58[_0x5546('0x1f')][_0x5546('0xb')]);const _0x8df0cb=_0x49ea81[_0x5546('0xc')];mysqldb[_0x5546('0x1d')](_0x5546('0x20'),[_0x8df0cb],function(_0x2a2917,_0x5768a6){if(_0x2a2917)throw _0x2a2917;_0x10b916['status'](0xc8)['send']({'success':_0x5768a6[_0x5546('0x21')]?!![]:![],'result':_0x5768a6});});});router[_0x5546('0x8')]('/programaciones-mensuales/crear-programacion-default',middleware[_0x5546('0x19')],(_0x304e83,_0x481e92,_0x3abab2)=>{const _0x431b3a=JSON[_0x5546('0xa')](_0x304e83['body']['json']);const _0x8457a0=_0x431b3a['registro_id'];const _0x2a3198=moment(new Date())[_0x5546('0x12')](_0x5546('0x13'));let _0x196698='';for(let _0x3c69b4=0x0;_0x3c69b4<0x5;_0x3c69b4++){_0x196698+='('+_0x8457a0+',\x27'+_0x2a3198+'\x27)'+(!(_0x3c69b4==0x4)?',':'');}mysqldb[_0x5546('0x1d')](_0x5546('0x22')+_0x196698,(_0x389ad1,_0x320398)=>{if(_0x389ad1)throw _0x389ad1;_0x481e92[_0x5546('0x16')]({'success':_0x320398[_0x5546('0x17')]?!![]:![],'result':_0x320398});});});router[_0x5546('0x23')](_0x5546('0x24'),middleware[_0x5546('0x19')],(_0x19c21c,_0xac4c53,_0x8e3017)=>{mysqldb[_0x5546('0x1d')]('\x0a\x20\x20SELECT\x20*\x0a\x20\x20FROM\x20programaciones_mensuales\x0a\x20\x20WHERE\x20date_format(fecha_modificacion,\x27%m\x27)=date_format(now(),\x27%m\x27)',function(_0x4cc605,_0x53da01){if(_0x4cc605)throw _0x4cc605;_0xac4c53[_0x5546('0x15')](0xc8)[_0x5546('0x16')]({'success':_0x53da01[_0x5546('0x21')]?!![]:![],'result':_0x53da01});});});router[_0x5546('0x8')](_0x5546('0x25'),middleware['ensureAuthenticated'],(_0x4ee92e,_0x8d8481,_0x4fe0bd)=>{const _0x41a4c4=JSON['parse'](_0x4ee92e['body'][_0x5546('0xb')]);const _0x1ac761=_0x41a4c4[_0x5546('0x26')];const _0x19d41d=_0x41a4c4[_0x5546('0x27')];const _0x3a0e91=_0x41a4c4[_0x5546('0x28')];const _0x503989=_0x41a4c4[_0x5546('0x29')];const _0x48578d=_0x41a4c4[_0x5546('0x2a')];const _0x53f66e=_0x41a4c4[_0x5546('0x2b')];const _0x323f89=_0x41a4c4[_0x5546('0x2c')];const _0x572e5e=_0x41a4c4[_0x5546('0x2d')];const _0x7a37ae=_0x41a4c4[_0x5546('0x2e')];const _0x19fd7a=_0x41a4c4[_0x5546('0x2f')];const _0x3e5b15=_0x41a4c4['gestion'];const _0x4fe325=_0x41a4c4[_0x5546('0x30')];const _0x568027=_0x41a4c4[_0x5546('0x31')];const _0x1aa8b5=_0x41a4c4['aclaracion_firma_sp'];const _0x4ed14e=_0x41a4c4[_0x5546('0x32')];const _0x1ea8f7=_0x41a4c4[_0x5546('0x33')];ruta=__dirname[_0x5546('0x34')]('\x5croutes\x5cprogramaciones_mensuales','')+_0x5546('0x35');let _0x4de773=ruta+_0x5546('0x36');let _0x1629dc=os['platform']()[_0x5546('0xf')]();if(_0x1629dc===_0x5546('0x37')){ruta=__dirname[_0x5546('0x34')]('/routes/programaciones_mensuales','')+_0x5546('0x38');_0x4de773=ruta+_0x5546('0x39');}var _0x35683e=fs['readFileSync'](ruta+'pomi.docx',_0x5546('0x3a'));var _0x1eb8bf=new JSZip(_0x35683e);var _0x1b842a=new Docxtemplater();_0x1b842a['loadZip'](_0x1eb8bf);_0x1b842a[_0x5546('0x3b')]({'nombres':_0x19d41d,'apellido_paterno':_0x3a0e91,'apellido_materno':_0x503989,'cargo':_0x48578d,'nivel_salarial':_0x53f66e,'secretaria':_0x323f89,'direccion_jefatura':_0x572e5e,'relacion_laboral':_0x7a37ae,'numero':_0x19fd7a,'gestion':_0x3e5b15,'aclaracion_cambio_area':_0x4fe325,'objetivo_cargo':_0x568027,'aclaracion_firma_sp':_0x1aa8b5,'fecha_elaboracion_sp':_0x4ed14e,'productos':_0x1ea8f7});try{_0x1b842a[_0x5546('0x3c')]();}catch(_0x86588c){var _0xcf230e={'message':_0x86588c[_0x5546('0x3d')],'name':_0x86588c[_0x5546('0x3e')],'stack':_0x86588c[_0x5546('0x3f')],'properties':_0x86588c[_0x5546('0x40')]};console[_0x5546('0x41')](JSON[_0x5546('0x42')]({'error':_0xcf230e}));throw _0x86588c;}var _0x150b42=_0x1b842a['getZip']()[_0x5546('0x43')]({'type':_0x5546('0x44')});fs[_0x5546('0x45')](_0x4de773+_0x1ac761+_0x5546('0x46'),_0x150b42);_0x8d8481[_0x5546('0x15')](0xc8)[_0x5546('0x16')]({'success':!![]});});module['exports']=router;