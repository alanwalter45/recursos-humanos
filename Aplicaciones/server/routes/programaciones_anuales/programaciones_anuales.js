var _0x560f=['binary','loadZip','setData','render','message','name','stack','properties','log','stringify','getZip','generate','nodebuffer','writeFileSync','.docx','exports','Router','moment','../../databaseMysql','../../middleware','docxtemplater','post','/programaciones-anuales/add-actividad','ensureAuthenticated','parse','body','json','registro_id','fecha_inicio','format','YYYY-MM-DD\x20HH:mm:ss','fecha_conclusion','producto','actividad','toUpperCase','status','affectedRows','/programaciones-anuales/edit-actividad','fuente_verificacion','query','/programaciones-anuales/get3-actividades','\x0a\x20\x20SELECT\x20*\x20from\x20\x20actividades_productos_programaciones_anuales\x0a\x20\x20WHERE\x20producto_programacion_anual_id=?','length','/programaciones-anuales/get-programacion-anual-registro','\x0a\x20\x20SELECT\x20pm.*\x20from\x20programaciones_anuales\x20pm\x20left\x20join\x20registros\x20re\x20on\x20pm.registro_id=re.id\x0a\x20\x20where\x20pm.registro_id=?\x20AND\x20date_format(pm.fecha_modificacion,\x27%y\x27)=date_format(now(),\x27%y\x27)','send','/programaciones-anuales/get-programacion-anual','/programaciones-anuales/get-productos-programacion-anual','/programaciones-anuales/update-programacion-anual','aclaracion_cambio_area','aclaracion_firma','objetivo_cargo','\x0a\x20\x20UPDATE\x20programaciones_anuales\x20SET\x20aclaracion_cambio_area=?,\x20aclaracion_firma=?\x20,\x20objetivo_cargo=?\x0a\x20\x20where\x20registro_id=?\x20AND\x20date_format(fecha_modificacion,\x27%y\x27)=date_format(now(),\x27%y\x27)','/programaciones-anuales/update-producto-programacion-anual','/programaciones-anuales/update-actividad-producto-programacion-anual','/programaciones-anuales/crear-programacion-default','INSERT\x20INTO\x20productos_programaciones_anuales(producto,\x20fecha_modificacion,programacion_anual_id)\x0a\x20\x20\x20\x20\x20\x20VALUES\x20(\x27producto','\x27,?,?)','INSERT\x20INTO\x20actividades_productos_programaciones_anuales(actividad,\x20fecha_modificacion,producto_programacion_anual_id)\x0a\x20\x20\x20\x20\x20\x20VALUES\x20(\x27actidad','insertId','numero_documento','apellido_paterno','secretaria','direccion_jefatura','relacion_laboral','numero','gestion','fecha_elaboracion_sp','productos','replace','programaciones-anuales\x5c','platform','linux','/public/assets/docs/','/programaciones-anuales/','readFileSync'];(function(_0x22fa12,_0x30dfd6){var _0x3968f9=function(_0x487566){while(--_0x487566){_0x22fa12['push'](_0x22fa12['shift']());}};_0x3968f9(++_0x30dfd6);}(_0x560f,0xf4));var _0x1dc9=function(_0x2d2bfb,_0x4c3732){_0x2d2bfb=_0x2d2bfb-0x0;var _0x4c61f8=_0x560f[_0x2d2bfb];return _0x4c61f8;};const express=require('express');const router=express[_0x1dc9('0x0')]();const moment=require(_0x1dc9('0x1'));const mysqldb=require(_0x1dc9('0x2'));const middleware=require(_0x1dc9('0x3'));var JSZip=require('jszip');var Docxtemplater=require(_0x1dc9('0x4'));var fs=require('fs');var path=require('path');const os=require('os');router[_0x1dc9('0x5')](_0x1dc9('0x6'),middleware[_0x1dc9('0x7')],(_0x22e967,_0x211986,_0xeb8254)=>{const _0x1c1763=JSON[_0x1dc9('0x8')](_0x22e967[_0x1dc9('0x9')][_0x1dc9('0xa')]);const _0x361751=_0x1c1763[_0x1dc9('0xb')];const _0x350eb8=moment(_0x1c1763[_0x1dc9('0xc')])[_0x1dc9('0xd')](_0x1dc9('0xe'));const _0xb5b70b=moment(_0x1c1763[_0x1dc9('0xf')])[_0x1dc9('0xd')](_0x1dc9('0xe'));const _0x1dd97d=_0x1c1763[_0x1dc9('0x10')];const _0x3918ae=_0x1c1763[_0x1dc9('0x11')]['toString']()[_0x1dc9('0x12')]();const _0x25267d=moment(new Date())[_0x1dc9('0xd')](_0x1dc9('0xe'));mysqldb['query']('\x0a\x20\x20INSERT\x20INTO\x20programaciones_anuales(producto,actividad,fecha_inicio,\x20fecha_conclusion,\x20fecha_modificacion,\x20registro_id)\x0a\x20\x20select\x20?,?,?,?,?,?\x0a\x20\x20WHERE\x20NOT\x20EXISTS(SELECT\x20*\x20FROM\x20programaciones_anuales\x0a\x20\x20\x20\x20WHERE\x20registro_id=?\x20and\x20actividad=?)',[_0x1dd97d,_0x3918ae,_0x350eb8,_0xb5b70b,_0x25267d,_0x361751,_0x361751,_0x3918ae],function(_0x54651c,_0x2313a0){if(_0x54651c)throw _0x54651c;_0x211986[_0x1dc9('0x13')](0xc8)['send']({'success':_0x2313a0[_0x1dc9('0x14')]?!![]:![],'result':_0x2313a0[_0x1dc9('0x14')]});});});router[_0x1dc9('0x5')](_0x1dc9('0x15'),middleware[_0x1dc9('0x7')],(_0xa6c739,_0xbc00f6,_0x4ace3e)=>{const _0x131008=JSON[_0x1dc9('0x8')](_0xa6c739[_0x1dc9('0x9')][_0x1dc9('0xa')]);const _0x1f9cbf=_0x131008['id'];const _0x2d705a=_0x131008[_0x1dc9('0xc')]?moment(_0x131008[_0x1dc9('0xc')])[_0x1dc9('0xd')](_0x1dc9('0xe')):null;const _0x4efd1f=_0x131008[_0x1dc9('0xf')]?moment(_0x131008[_0x1dc9('0xf')])[_0x1dc9('0xd')](_0x1dc9('0xe')):null;const _0x29400d=_0x131008['producto']?_0x131008['producto']:'';const _0x1b7127=_0x131008[_0x1dc9('0x11')]?_0x131008[_0x1dc9('0x11')]['toString']()['toUpperCase']():'';const _0x37bc73=_0x131008['fuente_verificacion']?_0x131008[_0x1dc9('0x16')]['toString']()[_0x1dc9('0x12')]():'';const _0x3740e1=moment(new Date())[_0x1dc9('0xd')](_0x1dc9('0xe'));mysqldb[_0x1dc9('0x17')]('\x0a\x20\x20UPDATE\x20programaciones_anuales\x20SET\x20producto=?,\x20actividad=?,\x20fecha_inicio=?,fecha_conclusion=?,\x20fecha_modificacion=?,\x20fuente_verificacion=?\x0a\x20\x20WHERE\x20id=?',[_0x29400d,_0x1b7127,_0x2d705a,_0x4efd1f,_0x3740e1,_0x37bc73,_0x1f9cbf],function(_0x771c45,_0x5a8c16){if(_0x771c45)throw _0x771c45;_0xbc00f6[_0x1dc9('0x13')](0xc8)['send']({'success':_0x5a8c16[_0x1dc9('0x14')]?!![]:![],'result':_0x5a8c16[_0x1dc9('0x14')]});});});router[_0x1dc9('0x5')](_0x1dc9('0x18'),middleware[_0x1dc9('0x7')],(_0x7f986b,_0x4d1858,_0x1ef42c)=>{const _0x3f6a52=JSON[_0x1dc9('0x8')](_0x7f986b[_0x1dc9('0x9')][_0x1dc9('0xa')]);const _0x5ec98f=_0x3f6a52['id'];mysqldb['query'](_0x1dc9('0x19'),[_0x5ec98f],function(_0x4fdd07,_0x310840){if(_0x4fdd07)throw _0x4fdd07;_0x4d1858['status'](0xc8)['send']({'success':_0x310840[_0x1dc9('0x1a')]?!![]:![],'result':_0x310840});});});router[_0x1dc9('0x5')](_0x1dc9('0x1b'),middleware['ensureAuthenticated'],(_0x4ce4fe,_0x5e6a8c,_0x12132a)=>{const _0x18ada2=JSON[_0x1dc9('0x8')](_0x4ce4fe[_0x1dc9('0x9')][_0x1dc9('0xa')]);const _0x1169e4=_0x18ada2[_0x1dc9('0xb')];mysqldb[_0x1dc9('0x17')](_0x1dc9('0x1c'),[_0x1169e4],function(_0xb84b24,_0x37f1c7){if(_0xb84b24)throw _0xb84b24;_0x5e6a8c[_0x1dc9('0x13')](0xc8)[_0x1dc9('0x1d')]({'success':_0x37f1c7[_0x1dc9('0x1a')]?!![]:![],'result':_0x37f1c7});});});router['post'](_0x1dc9('0x1e'),middleware[_0x1dc9('0x7')],(_0x58b7cf,_0x1b934a,_0x3d9ef2)=>{const _0x4a44d3=JSON['parse'](_0x58b7cf[_0x1dc9('0x9')][_0x1dc9('0xa')]);const _0x52b60a=_0x4a44d3[_0x1dc9('0xb')];mysqldb['query'](_0x1dc9('0x1c'),[_0x52b60a],function(_0xe8196b,_0x489d15){if(_0xe8196b)throw _0xe8196b;_0x1b934a[_0x1dc9('0x13')](0xc8)[_0x1dc9('0x1d')]({'success':_0x489d15[_0x1dc9('0x1a')]?!![]:![],'result':_0x489d15[0x0]});});});router[_0x1dc9('0x5')](_0x1dc9('0x1f'),middleware[_0x1dc9('0x7')],(_0x420e0c,_0x2dd102,_0x2f10b7)=>{const _0x2b1f13=JSON['parse'](_0x420e0c[_0x1dc9('0x9')][_0x1dc9('0xa')]);const _0x21a185=_0x2b1f13['id'];mysqldb[_0x1dc9('0x17')]('\x0a\x20\x20SELECT\x20ppm.*\x20FROM\x20programaciones_anuales\x20pa\x20LEFT\x20JOIN\x20productos_programaciones_anuales\x20ppm\x0a\x20\x20ON\x20ppm.programacion_anual_id=pa.id\x0a\x20\x20where\x20pa.id=?\x20AND\x20date_format(pa.fecha_modificacion,\x27%y\x27)=date_format(now(),\x27%y\x27)',[_0x21a185],function(_0x2ae376,_0x4727eb){if(_0x2ae376)throw _0x2ae376;_0x2dd102[_0x1dc9('0x13')](0xc8)['send']({'success':_0x4727eb[_0x1dc9('0x1a')]?!![]:![],'result':_0x4727eb});});});router[_0x1dc9('0x5')](_0x1dc9('0x20'),middleware[_0x1dc9('0x7')],(_0x5c5283,_0x51e694,_0x5e0a32)=>{const _0x51de6f=JSON['parse'](_0x5c5283['body'][_0x1dc9('0xa')]);const _0x7132b6=_0x51de6f[_0x1dc9('0xb')];const _0x58e6d5=_0x51de6f[_0x1dc9('0x21')];const _0x424423=_0x51de6f[_0x1dc9('0x22')];const _0x2bd762=_0x51de6f[_0x1dc9('0x23')];mysqldb['query'](_0x1dc9('0x24'),[_0x58e6d5,_0x424423,_0x2bd762,_0x7132b6],function(_0x1ed778,_0x28395a){if(_0x1ed778)throw _0x1ed778;_0x51e694[_0x1dc9('0x13')](0xc8)[_0x1dc9('0x1d')]({'success':_0x28395a[_0x1dc9('0x14')]?!![]:![],'result':_0x28395a['affectedRows']});});});router[_0x1dc9('0x5')](_0x1dc9('0x25'),middleware[_0x1dc9('0x7')],(_0x13189b,_0x44135a,_0x2e3df8)=>{const _0x2986a3=JSON['parse'](_0x13189b[_0x1dc9('0x9')][_0x1dc9('0xa')]);const _0x4c60d9=_0x2986a3['id'];const _0x1d7963=_0x2986a3[_0x1dc9('0x10')];const _0x32f7da=_0x2986a3[_0x1dc9('0xc')];const _0x29fa57=_0x2986a3['fecha_conclusion'];const _0x3fb1bc=_0x2986a3[_0x1dc9('0x16')];const _0x102e02=_0x2986a3['porcentaje_asignado'];const _0x53ee49=moment(new Date())['format'](_0x1dc9('0xe'));mysqldb[_0x1dc9('0x17')]('\x0a\x20\x20UPDATE\x20productos_programaciones_anuales\x0a\x20\x20SET\x20producto\x20=\x20?,\x0a\x20\x20\x20\x20\x20\x20fecha_inicio=?,\x0a\x20\x20\x20\x20\x20\x20fecha_conclusion=?,\x0a\x20\x20\x20\x20\x20\x20fuente_verificacion=?,\x0a\x20\x20\x20\x20\x20\x20porcentaje_asignado=?,\x0a\x20\x20\x20\x20\x20\x20fecha_modificacion=?\x0a\x0a\x20\x20where\x20id=?\x20AND\x20date_format(fecha_modificacion,\x27%y\x27)=date_format(now(),\x27%y\x27)',[_0x1d7963,_0x32f7da,_0x29fa57,_0x3fb1bc,_0x102e02,_0x53ee49,_0x4c60d9],function(_0x43f7b4,_0x589d7b){if(_0x43f7b4)throw _0x43f7b4;_0x44135a[_0x1dc9('0x13')](0xc8)[_0x1dc9('0x1d')]({'success':_0x589d7b['affectedRows']?!![]:![],'result':_0x589d7b[_0x1dc9('0x14')]});});});router[_0x1dc9('0x5')](_0x1dc9('0x26'),middleware[_0x1dc9('0x7')],(_0x2e2389,_0x50a30c,_0x1b4290)=>{const _0xeeb24e=JSON[_0x1dc9('0x8')](_0x2e2389['body']['json']);const _0xc784bc=_0xeeb24e['id'];const _0x2cd501=_0xeeb24e[_0x1dc9('0x11')];const _0x333f98=moment(new Date())[_0x1dc9('0xd')](_0x1dc9('0xe'));mysqldb[_0x1dc9('0x17')]('\x0a\x20\x20UPDATE\x20actividades_productos_programaciones_anuales\x0a\x20\x20SET\x20actividad=?,\x0a\x20\x20\x20\x20\x20\x20fecha_modificacion=?\x0a\x0a\x20\x20where\x20id=?\x20AND\x20date_format(fecha_modificacion,\x27%y\x27)=date_format(now(),\x27%y\x27)',[_0x2cd501,_0x333f98,_0xc784bc],function(_0x3a0957,_0x3abd2d){if(_0x3a0957)throw _0x3a0957;_0x50a30c['status'](0xc8)[_0x1dc9('0x1d')]({'success':_0x3abd2d[_0x1dc9('0x14')]?!![]:![],'result':_0x3abd2d['affectedRows']});});});router[_0x1dc9('0x5')](_0x1dc9('0x27'),middleware[_0x1dc9('0x7')],(_0x219a37,_0xaa19a1,_0x6f46d2)=>{const _0x51a495=JSON[_0x1dc9('0x8')](_0x219a37[_0x1dc9('0x9')][_0x1dc9('0xa')]);const _0x262f66=_0x51a495[_0x1dc9('0xb')];const _0x189b96=moment(new Date())[_0x1dc9('0xd')](_0x1dc9('0xe'));query='';let _0x39b8df=0x0;mysqldb[_0x1dc9('0x17')]('INSERT\x20INTO\x20programaciones_anuales(registro_id,\x20fecha_modificacion)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,?)',[_0x262f66,_0x189b96],(_0xa6e8d9,_0x55f319)=>{if(_0xa6e8d9)throw _0xa6e8d9;for(let _0x43a3f3=0x0;_0x43a3f3<0xa;_0x43a3f3++){mysqldb[_0x1dc9('0x17')](_0x1dc9('0x28')+(_0x43a3f3+0x1)+_0x1dc9('0x29'),[_0x189b96,_0x55f319['insertId']],(_0x280aa3,_0x49b2fe)=>{if(_0x280aa3)throw _0x280aa3;for(let _0x43a3f3=0x0;_0x43a3f3<0x3;_0x43a3f3++){mysqldb[_0x1dc9('0x17')](_0x1dc9('0x2a')+ ++_0x39b8df+_0x1dc9('0x29'),[_0x189b96,_0x49b2fe[_0x1dc9('0x2b')]],(_0x39ea07,_0xa26ae3)=>{if(_0x39ea07)throw _0x39ea07;});}});}_0xaa19a1[_0x1dc9('0x1d')]({'success':_0x55f319['affectedRows']?!![]:![],'result':_0x55f319});});});router[_0x1dc9('0x5')]('/programaciones-anuales/exportar',middleware[_0x1dc9('0x7')],(_0x4521f0,_0x535175,_0x54bd71)=>{const _0x3a222a=JSON[_0x1dc9('0x8')](_0x4521f0[_0x1dc9('0x9')]['json']);const _0x97d2b5=_0x3a222a[_0x1dc9('0x2c')];const _0x53c390=_0x3a222a['nombres'];const _0x3404be=_0x3a222a[_0x1dc9('0x2d')];const _0x2fe848=_0x3a222a['apellido_materno'];const _0x4d931b=_0x3a222a['cargo'];const _0x11aa98=_0x3a222a['nivel'];const _0x3553b4=_0x3a222a[_0x1dc9('0x2e')];const _0x3df3b8=_0x3a222a[_0x1dc9('0x2f')];const _0xbfeaf3=_0x3a222a[_0x1dc9('0x30')];const _0x36f7e5=_0x3a222a[_0x1dc9('0x31')];const _0xcac6e0=_0x3a222a[_0x1dc9('0x32')];const _0x22bbf7=_0x3a222a[_0x1dc9('0x21')];const _0x4f81d4=_0x3a222a[_0x1dc9('0x23')];const _0x44f706=_0x3a222a['aclaracion_firma_sp'];const _0x1db4b1=_0x3a222a[_0x1dc9('0x33')];const _0x24c47a=_0x3a222a[_0x1dc9('0x34')];ruta=__dirname[_0x1dc9('0x35')]('\x5croutes\x5cprogramaciones_anuales','')+'\x5cpublic\x5cassets\x5cdocs\x5c';let _0x48f88a=ruta+_0x1dc9('0x36');let _0x867b29=os[_0x1dc9('0x37')]()['toString']();if(_0x867b29===_0x1dc9('0x38')){ruta=__dirname[_0x1dc9('0x35')]('/routes/programaciones_anuales','')+_0x1dc9('0x39');_0x48f88a=ruta+_0x1dc9('0x3a');}var _0xe42660=fs[_0x1dc9('0x3b')](ruta+'poai.docx',_0x1dc9('0x3c'));var _0xd80bdb=new JSZip(_0xe42660);var _0x48d8c2=new Docxtemplater();_0x48d8c2[_0x1dc9('0x3d')](_0xd80bdb);_0x48d8c2[_0x1dc9('0x3e')]({'nombres':_0x53c390,'apellido_paterno':_0x3404be,'apellido_materno':_0x2fe848,'cargo':_0x4d931b,'nivel_salarial':_0x11aa98,'secretaria':_0x3553b4,'direccion_jefatura':_0x3df3b8,'relacion_laboral':_0xbfeaf3,'numero':_0x36f7e5,'gestion':_0xcac6e0,'aclaracion_cambio_area':_0x22bbf7,'objetivo_cargo':_0x4f81d4,'aclaracion_firma_sp':_0x44f706,'fecha_elaboracion_sp':_0x1db4b1,'productos':_0x24c47a});try{_0x48d8c2[_0x1dc9('0x3f')]();}catch(_0x42db7f){var _0x1f8c6f={'message':_0x42db7f[_0x1dc9('0x40')],'name':_0x42db7f[_0x1dc9('0x41')],'stack':_0x42db7f[_0x1dc9('0x42')],'properties':_0x42db7f[_0x1dc9('0x43')]};console[_0x1dc9('0x44')](JSON[_0x1dc9('0x45')]({'error':_0x1f8c6f}));throw _0x42db7f;}var _0x4f3ed0=_0x48d8c2[_0x1dc9('0x46')]()[_0x1dc9('0x47')]({'type':_0x1dc9('0x48')});fs[_0x1dc9('0x49')](_0x48f88a+_0x97d2b5+_0x1dc9('0x4a'),_0x4f3ed0);_0x535175['status'](0xc8)[_0x1dc9('0x1d')]({'success':!![]});});module[_0x1dc9('0x4b')]=router;