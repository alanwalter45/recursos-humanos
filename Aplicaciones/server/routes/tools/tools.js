var _0x1ec6=['retraso','ausente','addRow','codigo_biometrico','numero_contrato','licencia_sin_goce_haber','FFFFFF00','FF00FF00','lastRow','height','printArea','A1:N','length','/biometrico/','then','BONO','fecha\x20inicio','fecha_inicio','matrimonio','defuncion','nacimiento','vacacion','baja\x20medica','baja_medica','viajes','comision','observaciones','\x0a\x20\x20\x20\x20SELECT\x20sp.codigo_biometrico,\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.carnet_identidad,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.nombre_completo,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.fecha_inicio,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.cargo,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.tipo_cargo,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.unidad_trabajo,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20resumen.matrimonio,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20resumen.duelo,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20resumen.nacimiento,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(resumen.licencia_sin_goce_haber/8)\x20as\x20licencia_sin_goce_haber,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(resumen.vacacion/8)\x20as\x20vacacion,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(resumen.baja_medica/8)\x20as\x20baja_medica,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(resumen.viaje/8)\x20as\x20viaje,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20resumen.ausente,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(resumen.comision/8)\x20as\x20comision\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20temp_userinfo\x20sp\x20INNER\x20JOIN\x20temp_resumen_calculos\x20resumen\x20ON\x20sp.codigo_biometrico=resumen.codigo_biometrico\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20sp.tipo_cargo\x20like\x20\x27%','%\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20resumen.fecha_importacion\x20like\x20\x27','%\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20sp.fecha_importacion\x20like\x20\x27','%\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20sp.nombre_completo\x0a\x20\x20\x20\x20','toFixed','duelo','viaje','FFFF3300','FFFF0000','FF23FF23','FFFF00F7','FFFF9400','FF00CC00','FF00FA00','get','/biometrico/resumen-calculos25-09-2018.xlsx','parallelize','UPDATE\x20servidores_publicos\x20SET\x20codigo_biometrico=?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20numero_documento=?','commit','/tools/status-system','arch','totalmem','freemem','cpus','model','hostname','exports','express','mdb','xlsx','./../../databaseMysql','./tools-global','./../../middleware','post','ensureAuthenticated','getPathSO','replace','/biometrico/resumen-calculos','getTime','format','.xlsx','readFile','SheetNames','Sheets','YYYY-MM-DD','query','DELETE\x20from\x20temp_resumen_calculos\x20where\x20fecha_importacion=?','(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',',\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27','\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27','\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',',\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','INSERT\x20INTO\x20temp_resumen_calculos(codigo_biometrico,carnet_identidad,nombre_completo,retraso,ausente,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vacacion,cumpleanhos,matrimonio,nacimiento,oficial,taller,viaje,duelo,baja_medica,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20hora_particular,licencia_sin_goce_haber,comision,fecha_importacion\x20)\x20VALUES\x20','status','send','stringify','/tools/import-mdb','DD-MM-YYYY','DELETE\x20from\x20temp_userinfo\x20where\x20fecha_importacion=?','(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',',\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27','\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27','\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27','\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27','\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27','\x27),','INSERT\x20INTO\x20temp_userinfo(codigo_biometrico,carnet_identidad,nombre_completo,genero,cargo,telefono,fecha_nacimiento,fecha_inicio,direccion,ciudad,estado,numero_contrato,tipo_cargo,unidad_trabajo,tickeado,fecha_importacion)\x20VALUES\x20','affectedRows','getCell','alignment','middle','indexOf','center','thin','font','Times\x20New\x20Roman','mediumGray','parse','body','json','option','Workbook','lastModifiedBy','alanwalter45','created','modified','lastPrinted','addWorksheet','landscape','pageSetup','split','SUELDO','columns','codigo\x20biometrico','carnet\x20identidad','carnet_identidad','nombre\x20completo','nombre_completo','tipo\x20de\x20cargo','tipo_cargo','numero\x20de\x20cargo','numero_cargo','cargo','unidad_trabajo','atrazos\x20en\x20minutos','atrazos_minutos','faltas','L.S.G.H','tiempo\x20en\x20dias','tiempo_dias','\x0a\x20\x20\x20\x20SELECT\x20sp.codigo_biometrico,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.carnet_identidad,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.nombre_completo,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.tipo_cargo\x20as\x20vinculacion_laboral,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.numero_contrato,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.cargo,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sp.unidad_trabajo,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20resumen.retraso,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20resumen.ausente,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(resumen.licencia_sin_goce_haber/8)\x20as\x20licencia_sin_goce_haber\x0a\x20\x20\x20\x20FROM\x20temp_userinfo\x20sp\x20INNER\x20JOIN\x20temp_resumen_calculos\x20resumen\x20ON\x20sp.codigo_biometrico=resumen.codigo_biometrico\x0a\x20\x20\x20\x20WHERE\x20sp.tipo_cargo\x20like\x20\x27%','%\x27\x20AND\x20resumen.fecha_importacion\x20like\x20\x27','%\x27\x20\x0a\x20\x20\x20\x20AND\x20sp.fecha_importacion\x20like\x20\x27','forEach'];(function(_0x189121,_0x461637){var _0x516936=function(_0x1fa903){while(--_0x1fa903){_0x189121['push'](_0x189121['shift']());}};_0x516936(++_0x461637);}(_0x1ec6,0x150));var _0x9304=function(_0x5e26be,_0x49d6b1){_0x5e26be=_0x5e26be-0x0;var _0x3a2092=_0x1ec6[_0x5e26be];return _0x3a2092;};const express=require(_0x9304('0x0'));const router=express['Router']();const mdb=require(_0x9304('0x1'));const os=require('os');const Excel=require('exceljs');const fs=require('fs');const XLSX=require(_0x9304('0x2'));const mysqldb=require(_0x9304('0x3'));const tools_global=require(_0x9304('0x4'));const moment=require('moment');const middleware=require(_0x9304('0x5'));router[_0x9304('0x6')]('/tools/import-xlsx',middleware[_0x9304('0x7')],(_0x1ef3f7,_0x22c0ce,_0x544f8c)=>{const _0x163539=tools_global[_0x9304('0x8')]();const _0x59bf64=_0x163539[_0x9304('0x9')]('\x20','\x20')+_0x9304('0xa')+moment(new Date()[_0x9304('0xb')]())[_0x9304('0xc')]('DD-MM-YYYY')+_0x9304('0xd');const _0x209981=XLSX[_0x9304('0xe')](_0x59bf64);const _0x52e917=_0x209981[_0x9304('0xf')][0x0];const _0x3c02a2=_0x209981[_0x9304('0x10')][_0x52e917];let _0x5719f6=0x0;row=0x2;const _0x5378a7=moment(new Date()[_0x9304('0xb')]())[_0x9304('0xc')](_0x9304('0x11'));mysqldb[_0x9304('0x12')](_0x9304('0x13'),[_0x5378a7],function(_0xe33072){if(_0xe33072)throw _0xe33072;let _0x1300ee='';while(_0x3c02a2['A'+row]!==undefined){_0x1300ee+=_0x9304('0x14')+(_0x3c02a2['A'+row]?_0x3c02a2['A'+row]['v']:0x0)+_0x9304('0x15')+(_0x3c02a2['B'+row]?_0x3c02a2['B'+row]['v']:'')+_0x9304('0x16')+(_0x3c02a2['C'+row]?_0x3c02a2['C'+row]['v']:'')+_0x9304('0x17')+(_0x3c02a2['F'+row]?_0x3c02a2['F'+row]['v'][_0x9304('0x9')](',','.'):'')+',\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3c02a2['H'+row]?_0x3c02a2['H'+row]['v']['replace'](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['T'+row]?_0x3c02a2['T'+row]['v']['replace'](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['U'+row]?_0x3c02a2['U'+row]['v']['replace'](',','.'):'')+',\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3c02a2['V'+row]?_0x3c02a2['V'+row]['v'][_0x9304('0x9')](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['AF'+row]?_0x3c02a2['AF'+row]['v']['replace'](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['W'+row]?_0x3c02a2['W'+row]['v'][_0x9304('0x9')](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['X'+row]?_0x3c02a2['X'+row]['v'][_0x9304('0x9')](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['Y'+row]?_0x3c02a2['Y'+row]['v'][_0x9304('0x9')](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['Z'+row]?_0x3c02a2['Z'+row]['v'][_0x9304('0x9')](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['AA'+row]?_0x3c02a2['AA'+row]['v']['replace'](',','.'):'')+',\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3c02a2['AB'+row]?_0x3c02a2['AB'+row]['v'][_0x9304('0x9')](',','.'):'')+_0x9304('0x18')+(_0x3c02a2['AD'+row]?_0x3c02a2['AD'+row]['v'][_0x9304('0x9')](',','.'):'')+',\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3c02a2['AN'+row]?_0x3c02a2['AN'+row]['v'][_0x9304('0x9')](',','.'):'')+_0x9304('0x15')+_0x5378a7+'\x27),';row++;_0x5719f6++;if(_0x5719f6>=0x4b0){break;}};_0x1300ee=_0x1300ee['replace'](/.$/,';');mysqldb[_0x9304('0x12')](_0x9304('0x19')+_0x1300ee,(_0x1cc603,_0x5bff87)=>{if(_0x1cc603)throw _0x1cc603;_0x22c0ce[_0x9304('0x1a')](0xc8)[_0x9304('0x1b')](JSON[_0x9304('0x1c')]({'result':_0x5bff87['affectedRows']?!![]:![],'rowLength':_0x5719f6}));});});});router['post'](_0x9304('0x1d'),middleware['ensureAuthenticated'],(_0x8ae40d,_0x134e77,_0x1f0737)=>{const _0x43f671=tools_global[_0x9304('0x8')]();const _0x44589=_0x43f671['replace']('\x20','\x20')+'/biometrico/backup'+moment(new Date()[_0x9304('0xb')]())[_0x9304('0xc')](_0x9304('0x1e'))+_0x9304('0xd');const _0x55331a=XLSX[_0x9304('0xe')](_0x44589);const _0x10a1b1=_0x55331a[_0x9304('0xf')][0x0];const _0x4cfd60=_0x55331a[_0x9304('0x10')][_0x10a1b1];let _0x18bcdf=0x0;row=0x2;const _0x117b30=moment(new Date()[_0x9304('0xb')]())['format'](_0x9304('0x11'));mysqldb['query'](_0x9304('0x1f'),[_0x117b30],function(_0x3ecedc){if(_0x3ecedc)throw _0x3ecedc;let _0x371670='';while(_0x4cfd60['A'+row]!==undefined){_0x371670+=_0x9304('0x20')+(_0x4cfd60['B'+row]?_0x4cfd60['B'+row]['v']:0x0)+_0x9304('0x21')+(_0x4cfd60['C'+row]?_0x4cfd60['C'+row]['v']:'')+'\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27'+(_0x4cfd60['D'+row]?_0x4cfd60['D'+row]['v']:'')+_0x9304('0x22')+(_0x4cfd60['E'+row]?_0x4cfd60['E'+row]['v']:'')+_0x9304('0x23')+(_0x4cfd60['F'+row]?_0x4cfd60['F'+row]['v']:'')+_0x9304('0x23')+(_0x4cfd60['G'+row]?_0x4cfd60['G'+row]['v']:'')+_0x9304('0x24')+(_0x4cfd60['H'+row]?_0x4cfd60['H'+row]['v']:'')+_0x9304('0x23')+(_0x4cfd60['I'+row]?_0x4cfd60['I'+row]['v']:'')+_0x9304('0x23')+(_0x4cfd60['J'+row]?_0x4cfd60['J'+row]['v']:'')+'\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27'+(_0x4cfd60['K'+row]?_0x4cfd60['K'+row]['v']:'')+_0x9304('0x23')+(_0x4cfd60['L'+row]?_0x4cfd60['L'+row]['v']:'')+_0x9304('0x23')+(_0x4cfd60['A'+row]?_0x4cfd60['A'+row]['v']:'')+'\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27'+(_0x4cfd60['N'+row]?_0x4cfd60['N'+row]['v']:'')+'\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27'+(_0x4cfd60['Y'+row]?_0x4cfd60['Y'+row]['v']:'')+_0x9304('0x25')+_0x117b30+_0x9304('0x26');row++;_0x18bcdf++;if(_0x18bcdf>=0x4b0){break;}};_0x371670=_0x371670[_0x9304('0x9')](/.$/,';');mysqldb[_0x9304('0x12')](_0x9304('0x27')+_0x371670,(_0x5479f0,_0x4ca97d)=>{if(_0x5479f0)throw _0x5479f0;_0x134e77[_0x9304('0x1a')](0xc8)['send'](JSON['stringify']({'result':_0x4ca97d[_0x9304('0x28')]?!![]:![],'rowLength':_0x18bcdf}));});});});function alineando_celda(_0x1ce5b3,_0x2ad03b,_0x2e7f2b=undefined){_0x1ce5b3[_0x9304('0x29')](_0x2ad03b)[_0x9304('0x2a')]={'wrapText':!![],'vertical':_0x9304('0x2b'),'horizontal':_0x2ad03b[_0x9304('0x2c')]('C')!==-0x1?'left':_0x9304('0x2d')};_0x1ce5b3[_0x9304('0x29')](_0x2ad03b)['border']={'top':{'style':'thin'},'left':{'style':_0x9304('0x2e')},'bottom':{'style':_0x9304('0x2e')},'right':{'style':_0x9304('0x2e')}};_0x1ce5b3[_0x9304('0x29')](_0x2ad03b)[_0x9304('0x2f')]={'name':_0x9304('0x30'),'family':0x4,'size':0x9,'underline':![],'bold':![]};}function aplicando_estilo_celda(_0x1a31c5,_0x5d0b96,_0x438f85){alineando_celda(_0x1a31c5,_0x5d0b96,_0x438f85);_0x1a31c5['getCell'](_0x5d0b96)['fill']={'type':'pattern','pattern':_0x9304('0x31'),'bgColor':{'argb':_0x438f85}};}router['post']('/tools/export-xlsx',middleware[_0x9304('0x7')],(_0x380b57,_0x201417,_0x2aeda3)=>{let _0x5cc1f4=JSON[_0x9304('0x32')](_0x380b57[_0x9304('0x33')][_0x9304('0x34')]);let _0x421d09=_0x5cc1f4[_0x9304('0x35')];let _0x308209=tools_global[_0x9304('0x8')]();var _0x5d1660=new Excel[(_0x9304('0x36'))]();_0x5d1660['creator']='alanwalter45\x20recursos-humanos';_0x5d1660[_0x9304('0x37')]=_0x9304('0x38');_0x5d1660[_0x9304('0x39')]=new Date();_0x5d1660[_0x9304('0x3a')]=new Date();_0x5d1660[_0x9304('0x3b')]=new Date();let _0x3a4468=_0x5d1660[_0x9304('0x3c')](_0x421d09,{'pageSetup':{'paperSize':undefined,'orientation':_0x9304('0x3d')}});_0x3a4468[_0x9304('0x3e')]['margins']={'left':0.5,'right':0.5,'top':0.5,'bottom':0.5,'header':0.5,'footer':0.5};if(_0x421d09[_0x9304('0x3f')]('\x20')[0x0]===_0x9304('0x40')){_0x3a4468[_0x9304('0x41')]=[{'header':_0x9304('0x42'),'key':'codigo_biometrico','width':0xa},{'header':_0x9304('0x43'),'key':_0x9304('0x44'),'width':0xf},{'header':_0x9304('0x45'),'key':_0x9304('0x46'),'width':0x3c},{'header':_0x9304('0x47'),'key':_0x9304('0x48'),'width':0xf},{'header':_0x9304('0x49'),'key':_0x9304('0x4a'),'width':0xa},{'header':_0x9304('0x4b'),'key':_0x9304('0x4b'),'width':0x23},{'header':'unidad\x20de\x20trabajo','key':_0x9304('0x4c'),'width':0x32},{'header':'minutos','key':'minutos','width':0x4},{'header':_0x9304('0x4d'),'key':_0x9304('0x4e'),'width':0x4},{'header':'faltas','key':_0x9304('0x4f'),'width':0x4},{'header':'faltas\x20segun\x20normativa','key':'faltas_normativa','width':0x4},{'header':_0x9304('0x50'),'key':'licencia_sin_goce_haber','width':0x4},{'header':_0x9304('0x51'),'key':_0x9304('0x52'),'width':0x4},{'header':'observaciones','key':'observaciones','width':0x4}];mysqldb['query'](_0x9304('0x53')+_0x421d09[_0x9304('0x3f')]('\x20')[0x1]+_0x9304('0x54')+moment(new Date())[_0x9304('0xc')](_0x9304('0x11'))+_0x9304('0x55')+moment(new Date())['format']('YYYY-MM-DD')+'%\x27\x0a\x20\x20\x20\x20ORDER\x20BY\x20sp.nombre_completo\x0a\x20\x20\x20\x20',(_0x8204f3,_0x29c113)=>{if(_0x8204f3)throw _0x8204f3;_0x29c113[_0x9304('0x56')]((_0x303aab,_0x2d9958)=>{let _0x17bf06=_0x303aab[_0x9304('0x57')]>=0x2e&&_0x303aab[_0x9304('0x57')]<=0x3c?0.5:_0x303aab[_0x9304('0x57')]>=0x3d&&_0x303aab[_0x9304('0x57')]<=0x5a?0x1:_0x303aab[_0x9304('0x57')]>=0x5b&&_0x303aab[_0x9304('0x57')]<=0x78?0x2:_0x303aab[_0x9304('0x57')]>=0x79&&_0x303aab['retraso']<=0x96?0x3:_0x303aab[_0x9304('0x57')]>=0x97?0x4:_0x303aab['retraso']==0x0?0x0:_0x303aab[_0x9304('0x57')];let _0x436d41=_0x303aab[_0x9304('0x58')]*0x2;_0x3a4468[_0x9304('0x59')]([_0x303aab[_0x9304('0x5a')],_0x303aab['carnet_identidad'],_0x303aab[_0x9304('0x46')],_0x303aab['vinculacion_laboral'],_0x303aab[_0x9304('0x5b')],_0x303aab[_0x9304('0x4b')],_0x303aab[_0x9304('0x4c')],_0x303aab['retraso']==0x0?'':_0x303aab[_0x9304('0x57')],_0x17bf06==0x0?'':_0x303aab[_0x9304('0x57')]>0x2d?_0x17bf06+'d':'',_0x303aab['ausente']==0x0?'':_0x303aab['ausente'],_0x303aab[_0x9304('0x58')]==0x0?'':_0x436d41==0x0?'':_0x436d41+'d',_0x303aab[_0x9304('0x5c')]==0x0?'':_0x303aab[_0x9304('0x5c')],_0x17bf06+_0x436d41+_0x303aab[_0x9304('0x5c')]===0x0?'':_0x303aab['retraso']>0x2d?_0x17bf06+_0x436d41+_0x303aab[_0x9304('0x5c')]+'d':_0x436d41+_0x303aab['licencia_sin_goce_haber']===0x0?'':_0x436d41+_0x303aab[_0x9304('0x5c')]+'d','-']);alineando_celda(_0x3a4468,'A'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'B'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'C'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'D'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'E'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'F'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'G'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'H'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'I'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'J'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'K'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'L'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'M'+(_0x2d9958+0x2));alineando_celda(_0x3a4468,'N'+(_0x2d9958+0x2));if(_0x303aab[_0x9304('0x57')]>0x2d){color=_0x9304('0x5d');aplicando_estilo_celda(_0x3a4468,'H'+(_0x2d9958+0x2),color);aplicando_estilo_celda(_0x3a4468,'I'+(_0x2d9958+0x2),color);}if(_0x303aab['licencia_sin_goce_haber']>0x0){color=_0x9304('0x5e');aplicando_estilo_celda(_0x3a4468,'L'+(_0x2d9958+0x2),color);}if(_0x303aab['ausente']>0x0){color='FFFF0000';aplicando_estilo_celda(_0x3a4468,'J'+(_0x2d9958+0x2),color);aplicando_estilo_celda(_0x3a4468,'K'+(_0x2d9958+0x2),color);}_0x3a4468[_0x9304('0x5f')][_0x9304('0x60')]=0x14;});_0x3a4468[_0x9304('0x3e')][_0x9304('0x61')]=_0x9304('0x62')+_0x29c113[_0x9304('0x63')];_0x5d1660[_0x9304('0x2')]['writeFile'](_0x308209+_0x9304('0x64')+_0x421d09+'.xlsx')[_0x9304('0x65')](()=>{_0x201417[_0x9304('0x1a')](0xc8)['send']({'result':!![],'dataArr':JSON[_0x9304('0x1c')](_0x29c113)});});});}else if(_0x421d09['split']('\x20')[0x0]===_0x9304('0x66')){_0x3a4468['columns']=[{'header':_0x9304('0x42'),'key':_0x9304('0x5a'),'width':0x5},{'header':_0x9304('0x43'),'key':_0x9304('0x44'),'width':0x7},{'header':_0x9304('0x45'),'key':_0x9304('0x46'),'width':0x3c},{'header':_0x9304('0x67'),'key':_0x9304('0x68'),'width':0xa},{'header':_0x9304('0x4b'),'key':_0x9304('0x4b'),'width':0x23},{'header':_0x9304('0x4c'),'key':_0x9304('0x4c'),'width':0x1e},{'header':_0x9304('0x47'),'key':_0x9304('0x48'),'width':0xa},{'header':_0x9304('0x69'),'key':'matrimonio','width':0x4},{'header':_0x9304('0x6a'),'key':_0x9304('0x6a'),'width':0x4},{'header':_0x9304('0x6b'),'key':'nacimiento','width':0x4},{'header':_0x9304('0x50'),'key':_0x9304('0x5c'),'width':0x4},{'header':_0x9304('0x6c'),'key':'vacacion','width':0x4},{'header':_0x9304('0x6d'),'key':_0x9304('0x6e'),'width':0x4},{'header':_0x9304('0x6f'),'key':_0x9304('0x6f'),'width':0x4},{'header':'faltas','key':_0x9304('0x4f'),'width':0x4},{'header':_0x9304('0x70'),'key':'comision','width':0x4},{'header':_0x9304('0x51'),'key':_0x9304('0x52'),'width':0x4},{'header':_0x9304('0x71'),'key':_0x9304('0x71'),'width':0x4}];mysqldb['query'](_0x9304('0x72')+_0x421d09[_0x9304('0x3f')]('\x20')[0x1]+_0x9304('0x73')+moment(new Date())[_0x9304('0xc')](_0x9304('0x11'))+_0x9304('0x74')+moment(new Date())[_0x9304('0xc')](_0x9304('0x11'))+_0x9304('0x75'),(_0x3b6dcf,_0xa452fa)=>{if(_0x3b6dcf)throw _0x3b6dcf;JSON[_0x9304('0x32')](JSON[_0x9304('0x1c')](_0xa452fa))[_0x9304('0x56')]((_0x3844af,_0xf806af)=>{_0x3a4468[_0x9304('0x59')]([_0x3844af['codigo_biometrico'],_0x3844af[_0x9304('0x44')],_0x3844af['nombre_completo'],moment(new Date((_0x3844af[_0x9304('0x68')]-(0x63df+0x1))*0x15180*0x3e8))['format'](_0x9304('0x1e')),_0x3844af[_0x9304('0x4b')],_0x3844af[_0x9304('0x4c')],_0x3844af[_0x9304('0x48')],_0x3844af['matrimonio']==0x0?'':_0x3844af[_0x9304('0x69')][_0x9304('0x76')](0x1),_0x3844af[_0x9304('0x77')]==0x0?'':_0x3844af[_0x9304('0x77')][_0x9304('0x76')](0x1),_0x3844af['nacimiento']==0x0?'':_0x3844af[_0x9304('0x6b')]['toFixed'](0x1),_0x3844af[_0x9304('0x5c')]==0x0?'':_0x3844af['licencia_sin_goce_haber']['toFixed'](0x1),_0x3844af[_0x9304('0x6c')]==0x0?'':_0x3844af['vacacion']['toFixed'](0x1),_0x3844af[_0x9304('0x6e')]==0x0?'':_0x3844af[_0x9304('0x6e')][_0x9304('0x76')](0x1),_0x3844af[_0x9304('0x78')]==0x0?'':_0x3844af[_0x9304('0x78')][_0x9304('0x76')](0x1),_0x3844af[_0x9304('0x58')]==0x0?'':_0x3844af[_0x9304('0x58')][_0x9304('0x76')](0x1),_0x3844af[_0x9304('0x70')]==0x0?'':_0x3844af[_0x9304('0x70')]['toFixed'](0x1),_0x3844af[_0x9304('0x69')]+_0x3844af[_0x9304('0x77')]+_0x3844af[_0x9304('0x6b')]+_0x3844af[_0x9304('0x5c')]+_0x3844af['vacacion']+_0x3844af[_0x9304('0x6e')]+_0x3844af[_0x9304('0x78')]+_0x3844af[_0x9304('0x58')]+_0x3844af[_0x9304('0x70')]===0x0?'':(_0x3844af['matrimonio']+_0x3844af[_0x9304('0x77')]+_0x3844af[_0x9304('0x6b')]+_0x3844af[_0x9304('0x5c')]+_0x3844af[_0x9304('0x6c')]+_0x3844af[_0x9304('0x6e')]+_0x3844af[_0x9304('0x78')]+_0x3844af[_0x9304('0x58')]+_0x3844af[_0x9304('0x70')])[_0x9304('0x76')](0x1)+'d','-']);alineando_celda(_0x3a4468,'B'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'C'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'A'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'D'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'E'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'F'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'G'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'H'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'I'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'J'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'K'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'L'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'M'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'N'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'O'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'P'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'Q'+(_0xf806af+0x2));alineando_celda(_0x3a4468,'R'+(_0xf806af+0x2));if(_0x3844af['matrimonio']>0x0){color='FFFFFF00';aplicando_estilo_celda(_0x3a4468,'H'+(_0xf806af+0x2),color);}if(_0x3844af['duelo']>0x0){color=_0x9304('0x79');aplicando_estilo_celda(_0x3a4468,'I'+(_0xf806af+0x2),color);}if(_0x3844af['nacimiento']>0x0){color=_0x9304('0x7a');aplicando_estilo_celda(_0x3a4468,'J'+(_0xf806af+0x2),color);}if(_0x3844af[_0x9304('0x5c')]>0x0){color=_0x9304('0x5d');aplicando_estilo_celda(_0x3a4468,'K'+(_0xf806af+0x2),color);}if(_0x3844af[_0x9304('0x6c')]>0x0){color=_0x9304('0x7b');aplicando_estilo_celda(_0x3a4468,'L'+(_0xf806af+0x2),color);}if(_0x3844af[_0x9304('0x6e')]>0x0){color=_0x9304('0x7c');aplicando_estilo_celda(_0x3a4468,'M'+(_0xf806af+0x2),color);}if(_0x3844af['viaje']>0x0){color=_0x9304('0x7d');aplicando_estilo_celda(_0x3a4468,'N'+(_0xf806af+0x2),color);}if(_0x3844af[_0x9304('0x58')]>0x0){color=_0x9304('0x7e');aplicando_estilo_celda(_0x3a4468,'O'+(_0xf806af+0x2),color);}if(_0x3844af[_0x9304('0x70')]>0x0){color=_0x9304('0x7f');aplicando_estilo_celda(_0x3a4468,'P'+(_0xf806af+0x2),color);}_0x3a4468['lastRow'][_0x9304('0x60')]=0x14;});_0x3a4468['pageSetup'][_0x9304('0x61')]=_0x9304('0x62')+_0xa452fa[_0x9304('0x63')];_0x5d1660['xlsx']['writeFile'](_0x308209+_0x9304('0x64')+_0x421d09+_0x9304('0xd'))[_0x9304('0x65')](()=>{_0x201417[_0x9304('0x1a')](0xc8)[_0x9304('0x1b')]({'result':!![]});});});}});router[_0x9304('0x80')]('/tools/cargar-cod-bio-xlsx',(_0x53d0d3,_0x102231,_0x2d6e62)=>{const _0x2e9f6d=tools_global['getPathSO']();const _0x4bef7f=_0x2e9f6d[_0x9304('0x9')]('\x20','\x20')+_0x9304('0x81');const _0x3f0b91=XLSX[_0x9304('0xe')](_0x4bef7f);const _0x4524d2=_0x3f0b91[_0x9304('0xf')][0x0];const _0x42b60=_0x3f0b91['Sheets'][_0x4524d2];let _0x3a2854=0x0;row=0x2;const _0x373ac0=moment(new Date()[_0x9304('0xb')]())[_0x9304('0xc')](_0x9304('0x11'));sqlitedb[_0x9304('0x82')](function(){mysqldb[_0x9304('0x12')]('begin\x20transaction');while(_0x42b60['A'+row]!==undefined){mysqldb[_0x9304('0x12')](_0x9304('0x83'),[_0x42b60['A'+row]?_0x42b60['A'+row]['v']:'',_0x42b60['B'+row]?_0x42b60['B'+row]['v']:''],_0x481780=>{if(_0x481780)throw _0x481780;});row++;_0x3a2854++;if(_0x3a2854>=0x4b0){break;}}mysqldb['query'](_0x9304('0x84'));_0x102231['status'](0xc8)['send'](JSON[_0x9304('0x1c')]({'result':!![],'rowLength':_0x3a2854}));});});router[_0x9304('0x80')](_0x9304('0x85'),middleware[_0x9304('0x7')],(_0x20d9c3,_0x5e207f,_0x27a15c)=>{_0x5e207f[_0x9304('0x1a')](0xc8)[_0x9304('0x1b')]({'success':!![],'result':{'arquitectura':os[_0x9304('0x86')](),'memoria_total':os[_0x9304('0x87')](),'memoria_libre':os[_0x9304('0x88')](),'cpus':os[_0x9304('0x89')]()[0x0][_0x9304('0x8a')],'hostname':os[_0x9304('0x8b')]}});});module[_0x9304('0x8c')]=router;